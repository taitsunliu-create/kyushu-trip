<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>ä¹å·è¦ªå­è‡ªé§•éŠ 2026</title>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #2563EB;      /* ä¸»è‰²è— */
            --secondary: #F59E0B;    /* è¼”è‰²é»ƒ */
            --bg: #F3F4F6;           /* èƒŒæ™¯ç° */
            --white: #FFFFFF;
            --text-main: #1F2937;
            --text-sub: #6B7280;
            --danger: #EF4444;
            --food-choice: #8B5CF6;  /* ç´«è‰²ç”¨æ–¼é¤é£Ÿé¸æ“‡ */
            --tag-food-bg: #EDE9FE;
            --tag-toyota: #E0E7FF;   /* æ·ºè—ç´« for Toyota */
            --info-bg: #E0F2F1;      /* è³‡è¨Šé èƒŒæ™¯è‰² */
            --info-text: #0D9488;    /* è³‡è¨Šé æ–‡å­—è‰² */
            --kumamoto-info-bg: #F0F9FF; /* ç†Šæœ¬è³‡è¨ŠèƒŒæ™¯ */
            --kumamoto-info-text: #0E7490; /* ç†Šæœ¬è³‡è¨Šæ–‡å­— */
            --beppu-info: #14B8A6;   /* åˆ¥åºœåœ°ç„å°ˆç”¨è‰² */
            --beppu-bg: #E0F2F1;
            
            /* Safe Area Variables */
            --safe-area-bottom: env(safe-area-inset-bottom);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: var(--bg);
            color: var(--text-main);
            margin: 0;
            padding: 0;
            padding-bottom: calc(80px + var(--safe-area-bottom)); /* åº•éƒ¨å°èˆªç©ºé–“ + å®‰å…¨å€åŸŸ */
        }

        /* Header - Modified for Side-by-Side Layout */
        header {
            background: linear-gradient(135deg, #1e40af, #3b82f6);
            color: var(--white);
            padding: 15px 20px;
            box-shadow: 0 4px 10px rgba(37, 99, 235, 0.2);
            position: relative;
            z-index: 10;
        }
        
        .header-content {
            display: flex;
            flex-direction: row; 
            justify-content: space-between;
            align-items: center;
            gap: 15px;
            max-width: 1200px;
            margin: 0 auto;
            flex-wrap: wrap; 
        }

        .header-title-area {
            flex: 1;
            min-width: 200px;
        }

        .header-title-area h1 { margin: 0; font-size: 1.6rem; font-weight: 700; white-space: nowrap; }
        .header-title-area .subtitle { font-size: 0.9rem; opacity: 0.9; margin-top: 5px; }
        .header-title-area .badge-trip { 
            background: rgba(255,255,255,0.2); 
            padding: 4px 10px; 
            border-radius: 20px; 
            font-size: 0.8rem; 
            display: inline-block;
            margin-top: 8px;
        }

        /* New Header Weather Box - Side Layout */
        .header-weather-box {
            flex: 0 0 auto; 
            border: 1px solid rgba(255, 255, 255, 0.6);
            border-radius: 50px; /* Pill shape */
            padding: 8px 20px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(5px);
            display: flex;
            align-items: center;
            color: white;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            min-height: 70px;
        }

        /* Weather Columns */
        .hw-col-loc {
            padding-right: 15px;
            border-right: 1px solid rgba(255,255,255,0.3);
            text-align: center;
            min-width: 80px;
        }
        .hw-loc { font-size: 1.1rem; font-weight: 700; display: block; line-height: 1.2; }
        .hw-date { font-size: 0.75rem; opacity: 0.9; display: block; margin-top: 4px; }

        .hw-col-main {
            padding: 0 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .hw-icon svg { width: 36px; height: 36px; filter: drop-shadow(0 1px 2px rgba(0,0,0,0.1)); }
        
        .hw-temp-group { text-align: center; }
        .hw-temp { font-size: 1.4rem; font-weight: 700; line-height: 1; }
        .hw-desc { font-size: 0.8rem; font-weight: 500; display: block; margin-top: 2px; }
        .hw-range { font-size: 0.7rem; opacity: 0.9; display: block; margin-top: 2px; font-family: monospace; }

        .hw-col-advice {
            padding-left: 15px;
            border-left: 1px solid rgba(255,255,255,0.3);
            max-width: 140px;
            font-size: 0.75rem;
            line-height: 1.3;
            opacity: 0.95;
            display: flex;
            align-items: center;
            min-height: 50px; /* Ensure height for border */
        }

        /* Container & Tabs */
        .container { display: none; padding: 20px; animation: fadeIn 0.3s ease; max-width: 800px; margin: 0 auto; }
        .container.active { display: block; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Cards */
        .card {
            background: var(--white);
            border-radius: 16px;
            padding: 16px;
            margin-bottom: 16px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.04);
            border: 1px solid rgba(0,0,0,0.03);
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            border-bottom: 1px solid #eee;
            padding-bottom: 8px;
        }
        .card-title { font-weight: 700; color: var(--primary); font-size: 1.05rem; }

        /* Day specific styles */
        .day-wrapper {
            background: var(--white);
            border-radius: 12px;
            margin-bottom: 12px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
            transition: box-shadow 0.2s;
        }

        .day-toggle {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            cursor: pointer;
            border-radius: 12px;
            border-left: 5px solid transparent; 
            transition: background-color 0.2s, border-left-color 0.3s;
        }
        
        .day-toggle:active { background-color: #F8F9FB; }
        .day-toggle.open { border-left-color: var(--primary); }

        .day-info h3 { margin: 0; font-size: 1.1rem; color: var(--text-main); }
        .day-info span { font-size: 0.85rem; color: var(--text-sub); }
        
        .toggle-icon { transition: transform 0.3s; font-size: 0.8rem; color: var(--text-sub); font-weight: 700; }
        .day-toggle.open .toggle-icon { transform: rotate(180deg); color: var(--primary); }

        .timeline { display: none; padding: 15px 15px 5px 30px; border-top: 1px solid #F3F4F6; }
        .timeline.show { display: block; }

        .event { position: relative; padding-left: 20px; margin-bottom: 24px; }
        .event:last-child { margin-bottom: 0; }
        .event::before {
            content: ''; position: absolute; left: -7px; top: 6px;
            width: 12px; height: 12px; border-radius: 50%;
            background: var(--white); border: 3px solid var(--secondary);
            z-index: 1;
        }
        
        /* Event Styles */
        .event-meal .activity { color: var(--food-choice); }
        .event-meal .desc { border-left: 2px solid var(--food-choice); padding-left: 8px; margin-top: 5px; }
        .time { font-size: 0.85rem; color: var(--text-sub); font-weight: 600; font-family: monospace; }
        .activity { font-size: 1rem; font-weight: 700; margin: 4px 0; color: var(--text-main); }
        .desc { font-size: 0.9rem; color: #555; line-height: 1.5; margin-bottom: 8px; }

        /* Tags */
        .tags { display: flex; flex-wrap: wrap; gap: 6px; }
        .tag { font-size: 0.75rem; padding: 2px 8px; border-radius: 6px; font-weight: 500; }
        .tag-food { background: var(--tag-food-bg); color: var(--food-choice); }
        .tag-move { background: #DBEAFE; color: #1E40AF; }
        .tag-stay { background: #D1FAE5; color: #059669; }
        .tag-spot { background: #FCE7F3; color: #BE185D; }
        .tag-kids { background: #E0F2FE; color: #0284C7; border: 1px solid #BAE6FD; }
        .tag-car { background: var(--tag-toyota); color: #4338CA; }
        .tag-relax { background: #FFFBEB; color: #D97706; border: 1px solid #FCD34D; }
        .tag-shrine { background: #FEE2E2; color: #B91C1C; border: 1px solid #FCA5A5; }
        .tag-flight { background: #BFDBFE; color: #1D4ED8; }
        .tag-tip { background: var(--info-bg); color: var(--info-text); }
        .tag-shop { background: var(--kumamoto-info-bg); color: var(--kumamoto-info-text); }
        .tag-beppu { background: var(--beppu-bg); color: var(--beppu-info); }
        .tag-snow { background: #E0F2FE; color: #0369A1; border: 1px solid #BAE6FD; }

        /* Buttons */
        .btn-map { display: inline-flex; align-items: center; text-decoration: none; color: var(--primary); font-size: 0.85rem; font-weight: 600; margin-top: 4px; padding: 4px 0; }
        .btn-map::before { content: 'ğŸ“'; margin-right: 4px; }
        .btn-link { background: var(--primary); color: white; text-decoration: none; padding: 10px 16px; border-radius: 8px; font-size: 0.9rem; display: block; text-align: center; margin-top: 10px; }
        .btn-link-sub { background: #EBF5FF; color: var(--primary); text-decoration: none; padding: 8px 12px; border-radius: 6px; font-size: 0.85rem; display: block; text-align: center; margin-top: 8px; border: 1px solid var(--primary); }
        .btn-link-tel { background: #D1FAE5; color: #059669; text-decoration: none; padding: 8px 12px; border-radius: 6px; font-size: 0.85rem; display: block; text-align: center; margin-top: 8px; border: 1px solid #059669; }
        .btn-link-tel::before { content: 'ğŸ“'; margin-right: 4px; }

        /* Info Grid */
        .info-grid { display: grid; grid-template-columns: 100px 1fr; gap: 10px; font-size: 0.9rem; margin-bottom: 8px; }
        .info-label { color: var(--text-sub); }
        .info-val { font-weight: 500; }
        .info-detail-box { border: 1px solid #D1D5DB; padding: 12px; border-radius: 8px; margin-top: 10px; }
        .info-detail-box h4 { margin: 0 0 8px 0; font-size: 1rem; color: var(--primary); }

        /* Info Sections */
        .info-section { background-color: var(--info-bg); padding: 15px; border-radius: 12px; margin-bottom: 16px; border: 1px solid #5EEAD4; }
        .info-section.kumamoto { background-color: var(--kumamoto-info-bg); border-color: #90CDF4; }
        .info-section.kumamoto h3 { color: var(--kumamoto-info-text); border-bottom: 2px solid #90CDF4; }
        .info-section.winter-drive { background-color: #FEF2F2; border-color: #FCA5A5; color: #B91C1C; }
        .info-section.winter-drive h3 { color: #B91C1C; border-bottom: 2px solid #FCA5A5; }
        .info-section h3 { color: var(--info-text); font-size: 1.2rem; margin-top: 0; border-bottom: 2px solid #5EEAD4; padding-bottom: 5px; margin-bottom: 15px; }

        /* Price table */
        .price-table { display: grid; grid-template-columns: 1fr 80px 80px; gap: 8px; font-size: 0.9rem; margin-top: 10px; }
        .price-header { font-weight: 700; color: var(--primary); padding-bottom: 4px; border-bottom: 1px solid var(--primary); }
        .price-item { padding: 4px 0; border-bottom: 1px dashed #DDD; }
        .price-item:last-child { border-bottom: none; }
        .price-item .detail { font-size: 0.8rem; color: var(--text-sub); }

        .safari-method { margin-top: 15px; padding: 10px; border-radius: 8px; border: 1px dashed var(--info-text); }
        .method-title { font-weight: 700; color: var(--primary); display: block; margin-bottom: 5px; font-size: 1rem; }
        .method-title.recommended { color: var(--danger); }
        .method-detail { font-size: 0.9rem; line-height: 1.5; color: #444; }

        /* Step List */
        .step-list { counter-reset: step-counter; padding-left: 0; list-style: none; margin-top: 10px; }
        .step-list li { position: relative; padding-left: 30px; margin-bottom: 10px; font-size: 0.9rem; line-height: 1.5; }
        .step-list li::before {
            counter-increment: step-counter;
            content: counter(step-counter);
            position: absolute; left: 0; top: 0;
            width: 20px; height: 20px;
            background-color: var(--primary);
            color: white;
            border-radius: 50%;
            text-align: center;
            font-size: 0.75rem;
            line-height: 20px;
        }

        /* Bottom Nav - Optimized for Safe Area */
        .nav-bar { 
            position: fixed; 
            bottom: 0; 
            left: 0; 
            width: 100%; 
            background: rgba(255,255,255,0.95); 
            backdrop-filter: blur(10px); 
            border-top: 1px solid #eee; 
            display: flex; 
            justify-content: space-around; 
            padding: 8px 0 calc(8px + var(--safe-area-bottom)); 
            box-shadow: 0 -4px 20px rgba(0,0,0,0.05); 
            z-index: 100; 
        }
        .nav-item { 
            text-align: center; 
            color: #9CA3AF; 
            font-size: 0.7rem; 
            cursor: pointer; 
            transition: color 0.2s; 
            flex-grow: 1; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center; 
            padding: 4px; /* Touch target */
        }
        .nav-item.active { color: var(--primary); }
        
        .nav-icon { 
            display: block; 
            margin-bottom: 4px; 
            height: 22px; 
            width: 22px;
        }
        .nav-icon svg {
            width: 100%;
            height: 100%;
            fill: none;
            stroke: currentColor;
            stroke-width: 2;
            stroke-linecap: round;
            stroke-linejoin: round;
        }

        .alert-box { background: #FEF2F2; border: 1px solid #FECACA; color: #991B1B; padding: 10px; border-radius: 8px; font-size: 0.85rem; margin-top: 8px; display: flex; gap: 8px; align-items: start; margin-bottom: 15px; }
        .event.optimized { border-left: 2px solid var(--secondary); padding-left: 28px; margin-left: -8px; background-color: #FFFDF5; padding-top: 5px; padding-bottom: 5px; border-radius: 4px; }
        
        /* AI Features Styles (Integrated) */
        .btn-ai-guide {
            background: linear-gradient(90deg, #8B5CF6, #EC4899);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
            cursor: pointer;
            margin-top: 10px;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: transform 0.2s;
            font-weight: 600;
        }
        .btn-ai-guide:active { transform: scale(0.95); }
        .btn-ai-guide svg { width: 14px; height: 14px; fill: currentColor; }

        /* New Style for Replay Button (Blue Theme) */
        .btn-ai-play {
            background: linear-gradient(135deg, #2563EB, #3B82F6); /* Blue Gradient */
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            cursor: pointer;
            margin-top: 10px;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            box-shadow: 0 2px 5px rgba(37, 99, 235, 0.2);
            transition: transform 0.2s;
            font-weight: 600;
        }
        .btn-ai-play:active { transform: scale(0.95); }
        .btn-ai-play svg { 
            width: 18px; 
            height: 18px; 
            fill: none; 
            stroke: currentColor; 
            stroke-width: 2; 
            stroke-linecap: round; 
            stroke-linejoin: round; 
        }

        /* AI Container Styles */
        .ai-header { font-size: 1.4rem; font-weight: 700; margin-bottom: 15px; color: #4B5563; display: flex; align-items: center; gap: 8px; border-bottom: 2px solid #E5E7EB; padding-bottom: 10px; }
        
        .ai-result-box {
            background: #F9FAFB;
            border: 1px solid #E5E7EB;
            border-radius: 16px;
            padding: 16px;
            min-height: 200px;
            overflow-y: auto;
            margin-bottom: 20px;
            font-size: 1rem;
            line-height: 1.7;
            color: #374151;
            white-space: pre-wrap;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.02);
            flex: 1; 
        }
        .ai-result-box strong { color: #7C3AED; }
        
        /* Updated Input Area Layout */
        .ai-input-wrapper { display: flex; flex-direction: column; gap: 10px; width: 100%; }
        
        /* Mobile: Prevent Zoom on Input */
        .ai-input {
            width: 100%; padding: 14px; border: 2px solid #E5E7EB;
            border-radius: 12px; outline: none; 
            font-size: 16px; /* 16px prevents iOS zoom */
            transition: border-color 0.2s;
        }
        .ai-input:focus { border-color: #3b82f6; }

        .ai-actions-row { display: flex; gap: 8px; width: 100%; }
        
        .btn-mode {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px; 
            font-size: 0.95rem;
            transition: transform 0.1s, opacity 0.2s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            min-height: 48px; /* Ensure touch target size */
            
            /* IMPORTANT: Prevent text selection/menu on long press */
            -moz-user-select: none;
                 user-select: none;
            -webkit-user-select: none;
            -webkit-touch-callout: none;
        }
        .btn-mode:active { transform: scale(0.96); opacity: 0.9; }
        
        .btn-mode svg {
            width: 20px;
            height: 20px;
            fill: none;
            stroke: currentColor;
            stroke-width: 2.5;
            stroke-linecap: round;
            stroke-linejoin: round;
        }

        .inline-icon {
            width: 1.1em;
            height: 1.1em;
            vertical-align: text-bottom;
            margin-right: 4px;
            fill: none;
            stroke: currentColor;
            stroke-width: 2.5;
            stroke-linecap: round;
            stroke-linejoin: round;
            display: inline-block;
        }
        .icon-consult { color: #2563EB; } 
        .icon-trans { color: #0EA5E9; }   

        .btn-mode.consult { background: linear-gradient(135deg, #1D4ED8, #3B82F6); }
        .btn-mode.trans { background: linear-gradient(135deg, #0EA5E9, #38BDF8); }
        .btn-mode.voice { background: linear-gradient(135deg, #06B6D4, #22D3EE); }
        .btn-mode.voice.disabled { background: #E5E7EB; color: #9CA3AF; cursor: not-allowed; } /* Disabled state */
        
        .btn-mode.voice.recording {
            background: linear-gradient(135deg, #EF4444, #F87171); 
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(239, 68, 68, 0); }
            100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }
        }

        .btn-ai-reset {
            background: #F3F4F6; color: #6B7280; border: 1px solid #D1D5DB;
            padding: 10px 16px; border-radius: 8px; font-size: 0.9rem;
            cursor: pointer; margin-bottom: 15px; display: none;
            align-self: flex-end;
            width: 100%; /* Full width on mobile usually better for back buttons */
            text-align: center;
        }
        .btn-ai-reset:hover { background: #E5E7EB; }

        .loading-dots:after {
            content: ' .';
            animation: dots 1.5s steps(5, end) infinite;
        }
        @keyframes dots {
            0%, 20% { content: ' .'; }
            40% { content: ' ..'; }
            60% { content: ' ...'; }
            80%, 100% { content: ' ....'; }
        }

        /* Mobile Optimization */
        @media (max-width: 600px) {
            .container { padding: 15px 12px; } /* Adjust padding */
            
            /* Header adjustments */
            .header-content { flex-direction: column; align-items: flex-start; gap: 10px; }
            .header-title-area h1 { font-size: 1.5rem; white-space: normal; line-height: 1.3; }
            
            /* Compact Weather Box */
            .header-weather-box { 
                width: 100%; 
                justify-content: space-between; 
                padding: 10px 15px;
                border-radius: 12px;
                background: rgba(255, 255, 255, 0.15);
                min-height: auto;
            }
            .hw-col-advice { display: none; }
            .hw-col-main { flex-grow: 1; justify-content: flex-end; }
            .hw-col-loc { min-width: auto; border: none; padding-right: 0; text-align: left; }
            
            /* Compact Timeline */
            .timeline { padding-left: 15px; padding-right: 5px; } 
            .event { padding-left: 15px; }
            .event::before { left: -6px; }

            /* Optimized AI Buttons for Thumb Use */
            .ai-actions-row { 
                gap: 8px; 
            }
            .btn-mode {
                padding: 10px 4px;
                font-size: 0.8rem;
                flex-direction: column; /* Icon top, Text bottom */
                gap: 6px;
                line-height: 1.2;
                height: 70px; /* Taller easy to hit area */
            }
            .btn-mode svg { width: 24px; height: 24px; margin-bottom: 0; }
            
            /* Price Table scrollable if needed */
            .price-table { font-size: 0.85rem; }
        }
    </style>
</head>
<body>

    <header>
        <div class="header-content">
            <div class="header-title-area">
                <h1>ä¹å·è¦ªå­è‡ªé§•éŠ</h1>
                <div class="subtitle">2026/01/25 - 01/30 (6å¤©5å¤œ)</div>
                <div class="badge-trip">ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦ è¦ªå­è‡ªç”±è¡Œ â€¢ ç†Šæœ¬é€²ç¦å²¡å‡º</div>
            </div>

            <!-- å¤©æ°£è³‡è¨Šç›’ (æ“ºæ”¾åœ¨å³å´ï¼Œä¸‰æ¬„å¼è¨­è¨ˆ) -->
            <div class="header-weather-box" id="header-weather">
                <!-- 1. åœ°é»æ—¥æœŸ -->
                <div class="hw-col-loc">
                    <span class="hw-loc" id="hw-loc">ç†Šæœ¬å¸‚</span>
                    <span class="hw-date" id="hw-date">1/25 (Day 1)</span>
                </div>
                <!-- 2. æº«åº¦ç‹€æ…‹ -->
                <div class="hw-col-main">
                    <div class="hw-icon" id="hw-icon">
                        <!-- SVG Icon -->
                    </div>
                    <div class="hw-temp-group">
                        <div class="hw-temp" id="hw-temp">10Â°C</div>
                        <span class="hw-desc" id="hw-desc">æ™´æ™‚å¤šé›²</span>
                        <span class="hw-range" id="hw-range">2Â°C ~ 11Â°C</span>
                    </div>
                </div>
                <!-- 3. ç©¿è¡£å»ºè­° -->
                <div class="hw-col-advice" id="hw-advice">
                    æ°£æº«é©ä¸­ä½†æ—©æ™šåæ¶¼ï¼Œé•·è¢–é…å¤–å¥—ã€‚
                </div>
            </div>
        </div>
    </header>

    <!-- TAB 1: è¡Œç¨‹è¡¨ -->
    <div id="view-schedule" class="container active">
        <!-- Day 1 -->
        <div class="day-wrapper">
            <div class="day-toggle" id="toggle-d1" onclick="toggleTimeline('d1', this)">
                <div class="day-info">
                    <h3>Day 1: æŠµé”èˆ‡ç†Šæœ¬å¸‚å€</h3>
                    <span>1/25 (æ—¥) â€¢ ä½å®¿: The Blossom</span>
                </div>
                <div class="toggle-icon">â–¼</div>
            </div>
            <div id="d1" class="timeline">
                <div class="event">
                    <div class="time">11:00</div>
                    <div class="activity">æŠµé”ç†Šæœ¬æ©Ÿå ´ (KMJ)</div>
                    <div class="desc">é ˜å–è¡Œæå¾Œï¼Œå‰å¾€1æ¨“å…¥å¢ƒå¤§å»³å¤– 4è™Ÿä¹˜è»Šè™•ã€‚</div>
                    <div class="tags"><span class="tag tag-move">æ˜Ÿå®‡èˆªç©º</span></div>
                </div>
                <div class="event">
                    <div class="time">12:00</div>
                    <div class="activity">å‰å¾€ç†Šæœ¬å¸‚å€ (äº¤é€šé¸æ“‡)</div>
                    <div class="desc">
                        <ul style="list-style-type: disc; padding-left: 20px;">
                            <li><b>é¸é … A (ç›´é”å·´å£«)ï¼š</b> æ­ä¹˜åˆ©æœ¨æ´¥å·´å£«å¾€ã€Œç†Šæœ¬ç«™ã€ã€‚è»Šç¨‹ç´„60åˆ†ï¼Œæˆäººç´„1000å††ã€‚æœ€è¼•é¬†ï¼Œè¡Œæå…æ¬é‹ã€‚</li>
                            <li><b>é¸é … B (å…è²»æ¥é§+JR)ï¼š</b> æ­ä¹˜å…è²»ã€Œç©ºæ¸¯Linerã€è‡³è‚¥å¾Œå¤§æ´¥ç«™ (15åˆ†)ï¼Œè½‰ä¹˜ JR è±è‚¥æœ¬ç·šè‡³ç†Šæœ¬ç«™ (40åˆ†ï¼Œç´„480å††)ã€‚ä¸æ€•å¡è»Šï¼Œä½†éœ€è½‰ä¹˜ã€‚</li>
                            <li><b>é¸é … C (è¨ˆç¨‹è»Š)ï¼š</b> ç›´æ¥å‰å¾€é£¯åº—ï¼Œè»Šç¨‹ç´„ 45-50 åˆ†ï¼Œè»Šè³‡ç´„ 5000-6000å††ã€‚</li>
                        </ul>
                    </div>
                    <div class="tags"><span class="tag tag-move">å·´å£«</span><span class="tag tag-move">JRé›»è»Š</span></div>
                </div>
                <div class="event">
                    <div class="time">13:10</div>
                    <div class="activity">é£¯åº— Check-in / å¯„æ”¾è¡Œæ</div>
                    <div class="desc">The Blossom Kumamoto (JRç†Šæœ¬ç«™æ— Amu Plazaæ¨“ä¸Š)ã€‚</div>
                    <a href="https://www.google.com/maps/search/?api=1&query=THE+BLOSSOM+KUMAMOTO" target="_blank" class="btn-map">å°èˆª</a>
                </div>
                <div class="event event-meal">
                    <div class="time">13:30</div>
                    <div class="activity">åˆé¤/é»å¿ƒæ™‚æ®µï¼šç†Šæœ¬ç«™å‘¨é‚Š</div>
                    <div class="desc">
                        <ul style="list-style-type: disc;">
                            <li><b>è‚¥å¾Œå¥½ç‰©å¸‚å ´ï¼šï¼š</b> (ç†Šæœ¬ç«™å…§) æ¨è–¦ï¼šã„ããªã‚Šå›£å­ (é•·å£½åºµ)ã€ç«¹è¼ªæ²™æ‹‰ (ãƒ’ãƒ©ã‚¤)ã€‚å¿«é€Ÿè§£æ±ºã€‚</li>
                            <li><b>ç†Šæœ¬æ‹‰éºµï¼šï¼š</b> ç«™å‰æœ‰å¹¾é–“æ‹‰éºµåº—ï¼Œå¯å¿«é€Ÿé£½é¤ä¸€é “ã€‚</li>
                        </ul>
                    </div>
                    <div class="tags"><span class="tag tag-food">é¸æ“‡åˆé¤</span></div>
                </div>
                <div class="event">
                    <div class="time">15:00</div>
                    <div class="activity">ç†Šæœ¬åŸ / æ«»ä¹‹é¦¬å ´ åŸå½©è‹‘</div>
                    <div class="desc">
                        æ¬£è³å¤©å®ˆé–£å¤–è§€(ä¿®å¾©ä¸­)ï¼ŒåŸå½©è‹‘æœ‰è¨±å¤šè©¦åƒèˆ‡ç´€å¿µå“ã€‚
                        <div style="margin-top: 8px; border-top: 1px dashed #ccc; padding-top: 5px;">
                            <strong style="color: var(--food-choice); font-size: 0.9rem;">ğŸ˜‹ åŸå½©è‹‘å¿…åƒæ¨è–¦ï¼š</strong>
                            <ul style="list-style-type: disc; margin-top: 5px; padding-left: 20px; font-size: 0.9rem; color: #555;">
                                <li><b>æµ·è†½å¯æ¨‚é¤… (ã†ã«ã‚³ãƒ­ãƒƒã‚±)ï¼š</b> æ¿ƒéƒæµ·è†½å…§é¤¡ï¼Œå¤–é…¥å…§è»Ÿã€‚</li>
                                <li><b>è…ä¹ƒå±‹ é¦¬è‚‰å¯æ¨‚é¤…ï¼š</b> ä¸æ•¢åƒç”Ÿé¦¬è‚‰å¯ä»¥å˜—è©¦é€™å€‹ï¼Œç„¡è…¥å‘³ã€‚</li>
                                <li><b>æŠ¹èŒ¶éœœæ·‡æ·‹ (TENTE)ï¼š</b> ç†Šæœ¬ç”¢èŒ¶è‘‰è£½ä½œï¼ŒèŒ¶é¦™æ¿ƒåšã€‚</li>
                            </ul>
                        </div>
                    </div>
                    <button class="btn-ai-guide" onclick="askGeminiGuide('ç†Šæœ¬åŸå¤©å®ˆé–£èˆ‡å¿è€…', 'å‘Šè¨´5æ­²å°å­©é—œæ–¼é€™åº§åŸå ¡çš„å¿è€…æ•…äº‹æˆ–æ­¦å£«æ•…äº‹ï¼Œä¸¦çµ¦ä»–ä¸€å€‹å°‹æ‰¾åŸç‰†ä¸Šç‰¹æ®ŠçŸ³é ­çš„ä»»å‹™ã€‚')">
                        âœ¨ èªªæ•…äº‹çµ¦å­©å­è½
                    </button>
                    <a href="https://www.google.com/maps/search/?api=1&query=Sakuranobaba+Josaien" target="_blank" class="btn-map">å°èˆª</a>
                    <div class="tags"><span class="tag tag-spot">è¦ªå­æ•£æ­¥</span><span class="tag tag-food">é‚Šèµ°é‚Šåƒ</span></div>
                </div>
                <div class="event">
                    <div class="time">16:45</div>
                    <div class="activity">æ°´å‰å¯ºæˆè¶£åœ’ (æ—¥å¼åº­åœ’å‚™æ¡ˆ)</div>
                    <div class="desc">è‹¥ç†Šæœ¬åŸè¡Œç¨‹çµæŸå¾—æ—©ï¼Œå¯æ­å¸‚é›»Aç³»çµ±è‡³ã€Œæ°´å‰å¯ºå…¬åœ’ã€ã€‚æ—¥å¼åº­åœ’é€ æ™¯å„ªç¾ã€‚</div>
                    <a href="https://www.google.com/maps/search/?api=1&query=Suizenji+Jojuen" target="_blank" class="btn-map">å°èˆª</a>
                    <div class="tags"><span class="tag tag-kids">å‚™æ¡ˆ</span><span class="tag tag-spot">å…¬åœ’</span></div>
                </div>
                <div class="event">
                    <div class="time">18:00</div>
                    <div class="activity" style="color: var(--kumamoto-info-text);">ä¸Šé€š/ä¸‹é€š è³¼ç‰©è¡—æ•£ç­–</div>
                    <div class="desc">
                        åœ¨æ™šé¤å‰äº«å—å¸‚å€ç†±é¬§çš„æ‹±å»Šå•†åº—è¡—ã€‚å¯æ­ä¹˜å¸‚é›»è‡³ã€Œé€šç”ºç­‹ã€æˆ–ã€Œè¾›å³¶ç”ºã€ç«™ã€‚
                        <span style="display:block; font-weight: 600; margin-top: 5px;">***è©³ç›¡æ”»ç•¥èˆ‡ç¾é£Ÿé¸æ“‡è«‹è¦‹ã€Œæ—…éŠè³‡è¨Šã€é ç±¤ã€‚***</span>
                    </div>
                    <a href="https://www.google.com/maps/search/?api=1&query=Kamitori+Shopping+Street" target="_blank" class="btn-map">å°èˆªè‡³ä¸Šé€šè¡—</a>
                    <div class="tags"><span class="tag tag-shop">è³¼ç‰©</span><span class="tag tag-relax">ç¾é£Ÿé¸æ“‡å¤š</span></div>
                </div>
                <div class="event event-meal">
                    <div class="time">19:30</div>
                    <div class="activity">æ™šé¤æ™‚æ®µï¼šç†Šæœ¬å¸‚å€/è»Šç«™é¸æ“‡</div>
                    <div class="desc">
                        <ul style="list-style-type: disc;">
                            <li><b>å‹çƒˆäº­è±¬æ’ï¼šï¼š</b> (æ–°å¸‚è¡—/Amu Plaza) çŸ¥åæ—¥å¼è±¬æ’è€åº—ï¼Œç™½é£¯é«˜éº—èœå¯çºŒã€‚</li>
                            <li><b>å¤©å¤–å¤©æ‹‰éºµï¼šï¼šï¼š</b> (æ–°å¸‚è¡—) çŸ¥åè’œå‘³è±šéª¨æ‹‰éºµï¼Œé‡å£å‘³ã€‚</li>
                        </ul>
                    </div>
                    <a href="https://www.google.com/maps/search/?api=1&query=Katsuretsutei+Amu+Plaza+Kumamoto" target="_blank" class="btn-map">å‹çƒˆäº­å°èˆª</a>
                    <div class="tags"><span class="tag tag-food">é¸æ“‡æ™šé¤</span></div>
                </div>
                <div class="event">
                    <div class="time">21:00</div>
                    <div class="activity">æ™šé¤å¾Œå»ºè­°è¡Œç¨‹ (è‡ªç”±é¸æ“‡)</div>
                    <div class="desc">
                        <ul style="list-style-type: disc;">
                            <li><b>Amu Plaza è³¼ç‰© (æ¨è–¦)ï¼šï¼š</b> é£¯åº—æ¨“ä¸‹ï¼Œå¯é€›é€›è—¥å¦åº—æˆ–ä¼´æ‰‹ç¦®åº—ã€‚</li>
                            <li><b>è»Šç«™è¶…å¸‚è£œè²¨ï¼šï¼šï¼š</b> è³¼è²·éš”å¤©é›¶é£ŸåŠé£²å“ã€‚</li>
                            <li><b>é£¯åº—æ³¡æ¾¡ä¼‘æ¯ï¼šï¼šï¼š</b> ç¬¬ä¸€å¤©é•·é€”æ—…è¡Œï¼Œææ—©å›æˆ¿è®“å­©å­ä¼‘æ¯ã€‚</li>
                        </ul>
                    </div>
                    <div class="tags"><span class="tag tag-spot">è¼•é¬†</span><span class="tag tag-kids">è³¼ç‰©</span></div>
                </div>
            </div>
        </div>

        <!-- Day 2 -->
        <div class="day-wrapper">
            <div class="day-toggle" id="toggle-d2" onclick="toggleTimeline('d2', this)">
                <div class="day-info">
                    <h3>Day 2: è§€å…‰åˆ—è»Š & é»‘å·æº«æ³‰</h3>
                    <span>1/26 (ä¸€) â€¢ ä½å®¿: é»‘å·æº«æ³‰</span>
                </div>
                <div class="toggle-icon">â–¼</div>
            </div>
            <div id="d2" class="timeline">
                <div class="alert-box" style="background: #F7FCEF; border: 1px solid #D9F99D; color: #3F6212;">
                    <span>â±ï¸</span> 
                    <div><b>å„ªåŒ–ç›®æ¨™ï¼šï¼š</b>èª¿æ•´ä¸‹åˆè¡Œç¨‹æ™‚é–“ï¼Œç¢ºä¿ **17:05 å¾å¤§è§€å³°å‡ºç™¼**ï¼Œæ–¼ **18:00 æŠµé”é»‘å·æº«æ³‰**ã€‚</div>
                </div>
                <div class="event">
                    <div class="time">09:00</div>
                    <div class="activity">Check-out & å‰å¾€ç†Šæœ¬ç«™ JR æœˆå°</div>
                    <div class="desc">The Blossom å°±åœ¨ç†Šæœ¬ç«™æ—ï¼Œç§»å‹•éå¸¸æ–¹ä¾¿ï¼Œä½†ä»å»ºè­°é ç•™æ™‚é–“ã€‚</div>
                    <div class="tags"><span class="tag tag-move">ç§»å‹•</span></div>
                </div>
                <div class="event">
                    <div class="time">09:57</div>
                    <div class="activity">JR è§€å…‰åˆ—è»Šã€Œé˜¿è˜‡ç”·å­©!ã€</div>
                    <div class="desc">
                        ç¬¬3ç¯€è»Šå»‚è¨­æœ‰**æœ¨çƒæ± ã€å…’ç«¥åœ–æ›¸å®¤**å’Œå“ºä¹³å®¤ï¼Œè«‹é ç•™æ™‚é–“å¸¶å­©å­å»ç©ã€‚
                    </div>
                    <button class="btn-ai-guide" onclick="askGeminiGuide('é˜¿è˜‡ç”·å­©è™Ÿåˆ—è»Š', 'å‘å­©å­ä»‹ç´¹é€™å°ç«è»Šä¸Šçš„å°ç‹— Kuro é†¬æ˜¯èª°ï¼Œä¸¦å»ºè­°ä¸€å€‹åœ¨ç«è»Šä¸Šå¯ä»¥ç©çš„å°‹å¯¶éŠæˆ²ã€‚')">
                        âœ¨ Kuro é†¬æ˜¯èª°ï¼Ÿ
                    </button>
                    <!-- å‚™æ¡ˆ -->
                    <div style="margin-top:8px; border-top:1px dashed #ccc; padding-top:5px; font-size:0.85rem; color:#666;">
                        ğŸš‚ <b>åœé§›å‚™æ¡ˆï¼š</b> è‹¥é‡åœé§›ï¼Œå¯æ”¹æ­ <b>ä¹å·æ©«æ–·ç‰¹æ€¥ (09:11ç™¼)</b> æˆ– <b>æ™®é€šåˆ—è»Š</b>ã€‚é›–ç„¡è¦ªå­è¨­æ–½ï¼Œä½†ä»å¯æ¬£è³æ²¿é€”é¢¨æ™¯ã€‚
                    </div>
                    <div class="tags"><span class="tag tag-move">ç«è»Š</span><span class="tag tag-kids">è¦ªå­å¿…éŠ</span></div>
                </div>
                <div class="event">
                    <div class="time">11:27</div>
                    <div class="activity">æŠµé”é˜¿è˜‡ç«™ (å–è»Šæº–å‚™)</div>
                    <div class="desc">åˆ—è»Šæº–æ™‚æŠµé”é˜¿è˜‡ç«™ã€‚è«‹æº–å‚™å‰å¾€ç§Ÿè»Šè¡Œã€‚</div>
                    <div class="tags"><span class="tag tag-move">æŠµé”</span></div>
                </div>
                <div class="event">
                    <div class="time">11:40</div>
                    <div class="activity">Toyota ç§Ÿè»Š - é˜¿è˜‡ç«™å‰åº— (å–è»Š)</div>
                    <div class="desc">
                        <b>ç§Ÿè»Šè¡Œï¼šï¼š</b> Toyota Rent a Car é˜¿è˜‡ç«™å‰åº— (ãƒˆãƒ¨ã‚¿ãƒ¬ãƒ³ã‚¿ã‚«ãƒ¼é˜¿è˜‡é§…å‰åº—)ã€‚å»ºè­°é ç•™ 30-45 åˆ†é˜è¾¦ç†æ‰‹çºŒã€‚
                    </div>
                    <a href="https://www.google.com/maps/search/?api=1&query=Toyota+Rent+a+Car+é˜¿è˜‡é§…å‰åº—" target="_blank" class="btn-map">å°èˆªè‡³ç§Ÿè»Šè¡Œ</a>
                    <div class="tags"><span class="tag tag-car">Toyota</span><span class="tag tag-move">ç§Ÿè»Šé–‹å§‹</span></div>
                </div>
                <div class="event event-meal optimized">
                    <div class="time">12:20</div>
                    <div class="activity" style="color: var(--secondary);">åˆé¤æ™‚æ®µï¼šé˜¿è˜‡èµ¤ç‰›ä¸¼ (ç²¾ç°¡)</div>
                    <div class="desc">
                        <ul style="list-style-type: disc;">
                            <li>**èµ¤ç‰›ä¸¼ï¼š** æ¨è–¦å‰å¾€ **ã„ã¾ãã‚“é£Ÿå ‚** (éœ€è‡ªé§•ï¼Œç´„ 15-20 åˆ†é˜)ã€‚å› éœ€æ§åˆ¶æ™‚é–“ï¼Œå»ºè­°äº‹å…ˆé›»è©±é ç´„ï¼Œæˆ–é¸æ“‡äººæ½®è¼ƒå°‘çš„åŒé¡å‹é¤å»³ï¼Œ**å°‡ç”¨é¤æ™‚é–“æ§åˆ¶åœ¨ 60 åˆ†é˜å…§**ã€‚</li>
                        </ul>
                    </div>
                    <a href="https://www.google.com/maps/search/?api=1&query=ã„ã¾ãã‚“é£Ÿå ‚+é˜¿è˜‡" target="_blank" class="btn-map">å°èˆªè‡³ ã„ã¾ãã‚“é£Ÿå ‚</a>
                     <div class="tags"><span class="tag tag-food">æ™‚é–“ç·Šæ¹Š</span><span class="tag tag-car">éœ€è‡ªé§•</span></div>
                </div>
                 <div class="event optimized">
                    <div class="time">13:40</div>
                    <div class="activity" style="color: var(--secondary);">é˜¿è˜‡ç¥ç¤¾ (Aso Shrine)</div>
                    <div class="desc">
                        æŠµé”ç¥ç¤¾ä¸¦åƒè§€é–€å‰ç”ºï¼Œ**å»ºè­°åœç•™æ™‚é–“ç´„ 45 åˆ†é˜**ã€‚
                    </div>
                    <a href="https://www.google.com/maps/search/?api=1&query=Aso+Shine" target="_blank" class="btn-map">å°èˆª</a>
                    <div class="tags"><span class="tag tag-shrine">åœç•™ 45åˆ†</span></div>
                </div>
                <div class="event optimized">
                    <div class="time">14:45</div>
                    <div class="activity" style="color: var(--secondary);">è‰åƒé‡Œå’–å•¡çƒ˜ç„™åŠ (Kusasenri)</div>
                    <div class="desc">
                        æ¬£è³é˜¿è˜‡ç«å±±ç¾¤èˆ‡è‰åƒé‡Œæ”¾ç‰§ç¾æ™¯ï¼Œä¸¦äº«ç”¨å’–å•¡ã€‚**å»ºè­°åœç•™æ™‚é–“ç´„ 60 åˆ†é˜**ï¼Œé¿å…é€—ç•™éä¹…ã€‚
                    </div>
                    <a href="https://www.google.com/maps/search/?api=1&query=Kusasenri+Coffee+Roastery" target="_blank" class="btn-map">å°èˆª</a>
                    <div class="tags"><span class="tag tag-spot">åœç•™ 60åˆ†</span></div>
                </div>
                <div class="event optimized">
                    <div class="time">16:00</div>
                    <div class="activity" style="color: var(--secondary);">é˜¿è˜‡å¤§è§€å³° (Daikanbo Lookout)</div>
                    <div class="desc">
                        çœºæœ›é˜¿è˜‡äº”å²³ã€Œæ¶…æ§ƒåƒã€çµ•æ™¯ï¼Œåœè»Šå ´æ—æœ‰ä¼´æ‰‹ç¦®èˆ‡é»å¿ƒåº—ã€‚
                        <span style="color:var(--danger); font-weight: 600;">***é‡è¦ï¼šè«‹å‹™å¿…åœ¨ 17:05 å‰ä¸Šè»Šå‡ºç™¼***</span>ã€‚
                    </div>
                    <a href="https://www.google.com/maps/search/?api=1&query=Daikanbo+Lookout" target="_blank" class="btn-map">å°èˆª</a>
                    <div class="tags"><span class="tag tag-spot">æ™¯è§€</span></div>
                </div>
                <div class="event optimized">
                    <div class="time">17:05</div>
                    <div class="activity" style="color: var(--danger); font-weight: 700;">å‰å¾€é»‘å·æº«æ³‰ (è‡ªé§• 55åˆ†)</div>
                    <div class="desc">
                        <span style="color:var(--danger); font-weight: 600;">âš ï¸ å±±è·¯é§•é§›è«‹å°å¿ƒï¼šï¼š</span> å†¬å­£å±±è·¯ï¼Œè«‹å‹¿è¶…é€Ÿä¸¦æ³¨æ„å®‰å…¨ã€‚
                    </div>
                    <div class="tags"><span class="tag tag-move">æº–æ™‚å‡ºç™¼ï¼</span></div>
                </div>
                <div class="event event-meal">
                    <div class="time" style="color: var(--primary); font-weight: 700;">18:00</div>
                    <div class="activity" style="color: var(--primary); font-weight: 700;">æˆåŠŸæŠµé”é»‘å·æº«æ³‰æ—…é¤¨</div>
                    <div class="desc">è¾¦ç†å…¥ä½æ‰‹çºŒï¼Œæ”¾é¬†ä¼‘æ¯ã€‚</div>
                    <div class="info-detail-box" style="border: 1px dashed #10B981; margin-top: 15px;">
                        <h4 style="color:#10B981;">ğŸ‘‰ æ—…é¤¨å°èˆªè³‡è¨Š (é›»è©±)</h4>
                        <div class="info-grid">
                            <div class="info-label">éº“æ—…é¤¨</div>
                            <div class="info-val">0967-44-0103</div>
                        </div>
                        <div class="info-grid">
                            <div class="info-label">æ¹¯æœ¬èŠ</div>
                            <div class="info-val">0967-44-0211</div>
                        </div>
                        <span style="display: block; font-size: 0.8rem; color: #666; margin-top: 5px;">å»ºè­°ä½¿ç”¨é›»è©±è™Ÿç¢¼è¼¸å…¥è»Šç”¨å°èˆªã€‚</span>
                    </div>
                </div>
                <div class="event event-meal">
                    <div class="time">19:00</div>
                    <div class="activity">æ™šé¤: æ—…é¤¨æœƒå¸­æ–™ç†</div>
                    <div class="desc">åœ¨æ—…é¤¨äº«ç”¨ç²¾ç·»çš„æ—¥å¼æœƒå¸­æ™šé¤ (é€šå¸¸æ™šé¤æ™‚é–“ç‚º 18:30-19:30)ã€‚</div>
                    <div class="tags"><span class="tag tag-stay">æº«æ³‰æ—…é¤¨</span><span class="tag tag-food">å·²åŒ…å«</span></div>
                </div>
                <div class="event">
                    <div class="time">21:00</div>
                    <div class="activity">é»‘å·æº«æ³‰è¡— å¤œé–“æ•£ç­– (æ¥µæ¨è–¦)</div>
                    <div class="desc">
                        ç©¿è‘—æµ´è¡£ï¼Œæ¼«æ­¥æ–¼é»ç¶´è‘—æŸ”å’Œç‡ˆç± çš„æº«æ³‰è¡—ã€‚æ°£æ°›å¯§éœï¼Œéå¸¸é©åˆæ”¾é¬†ã€‚
                        <span style="display:block; margin-top: 5px;">âš ï¸ è«‹æ³¨æ„å†¬å­£ä¿æš–ï¼Œä¸¦ç¢ºä¿å­©å­è…³æ­¥å®‰å…¨ã€‚</span>
                    </div>
                    <a href="https://www.google.com/maps/search/?api=1&query=Kurokawa+Onsen+Town" target="_blank" class="btn-map">æº«æ³‰è¡—ä¸­å¿ƒå°èˆª</a>
                    <div class="tags"><span class="tag tag-relax">æ”¾é¬†</span><span class="tag tag-kids">è¦ªå­é«”é©—</span></div>
                </div>
            </div>
        </div>

        <!-- Day 3 -->
        <div class="day-wrapper">
            <div class="day-toggle" id="toggle-d3" onclick="toggleTimeline('d3', this)">
                <div class="day-info">
                    <h3>Day 3: åˆ¥åºœæµ·åœ°ç„ã€é‡ç”Ÿå‹•ç‰©åœ’ & ç”±å¸ƒé™¢</h3>
                    <span>1/27 (äºŒ) â€¢ ä½å®¿: ç”±å¸ƒé™¢</span>
                </div>
                <div class="toggle-icon">â–¼</div>
            </div>
            <div id="d3" class="timeline">
                <div class="alert-box" style="background: var(--beppu-bg); border: 1px solid var(--beppu-info); color: #075985;">
                    <span>â™¨ï¸</span> 
                    <div><b>è¡Œç¨‹æç¤ºï¼šï¼š</b>æµ·åœ°ç„å·²åŠ å…¥æ­¤è¡Œç¨‹ï¼æ‚¨å°‡å¾é»‘å·æº«æ³‰å‡ºç™¼ï¼Œ**åœ¨å‰å¾€ç”±å¸ƒé™¢çš„é€”ä¸­ç¶“éåˆ¥åºœä¸¦åƒè§€æµ·åœ°ç„**ï¼Œå®Œç¾ä¸²è¯è¡Œç¨‹ã€‚</div>
                </div>
                <div class="event event-meal">
                    <div class="time">08:00</div>
                    <div class="activity">æ—©é¤: æ—…é¤¨å…§äº«ç”¨</div>
                    <div class="desc">äº«ç”¨é»‘å·æº«æ³‰æ—…é¤¨è±ç››çš„æ—¥å¼æ—©é¤ã€‚</div>
                     <div class="tags"><span class="tag tag-stay">æº«æ³‰æ—…é¤¨</span><span class="tag tag-food">å·²åŒ…å«</span></div>
                </div>
                <div class="event">
                    <div class="time">09:30</div>
                    <div class="activity">é»‘å·æº«æ³‰æ•£ç­– & Check-out</div>
                    <div class="desc">åœ¨é€€æˆ¿å‰è³¼è²·ã€Œå…¥æ¹¯æ‰‹å½¢ã€é€›æº«æ³‰è¡—ï¼Œäº«å—æ—©æ™¨çš„å¯§éœã€‚</div>
                    <div class="tags"><span class="tag tag-relax">æ•£æ­¥</span></div>
                </div>
                <div class="event">
                    <div class="time">11:00</div>
                    <div class="activity">ç§»å‹•è‡³åˆ¥åºœåœ°ç„å€ (è‡ªé§• 1å°æ™‚30åˆ†)</div>
                    <div class="desc">è»Šç¨‹è¼ƒé•·ï¼Œå»ºè­°æº–å‚™å¥½å­©å­çš„é›¶é£Ÿå’Œå¨›æ¨‚ã€‚</div>
                    <div class="tags"><span class="tag tag-move">ç§»å‹•</span><span class="tag tag-car">é«˜é€Ÿ/å±±è·¯</span></div>
                </div>
                <div class="event">
                    <div class="time" style="color: var(--beppu-info); font-weight: 700;">12:30</div>
                    <div class="activity" style="color: var(--beppu-info); font-weight: 700;">æŠµé” åˆ¥åºœ æµ·åœ°ç„ (Umi Jigoku)</div>
                    <div class="desc">
                        åœ°ç„å·¡ç¦®ä¸­æœ€å¤¢å¹»çš„ä¸€è™•ï¼å› ä½”åœ°è¼ƒå¤§ï¼Œå»ºè­°åœç•™ç´„ **75åˆ†é˜**ã€‚
                        <ul style="list-style-type: disc; margin-top: 5px; padding-left: 20px;">
                            <li>**å¿…çœ‹ï¼šï¼š** éˆ·è—è‰²çš„æº«æ³‰æ°´ã€ç†±å¸¶ç¡è“®æ± ï¼ˆé¬¼è“®ï¼‰ã€æº«æ³‰é›è›‹ã€‚</li>
                            <li>**å‚™æ¡ˆï¼šï¼š** æµ·åœ°ç„æ—çš„ **ç¶åœ°ç„ï¼ˆKamado Jigokuï¼‰** ä¹Ÿå¾ˆæ¨è–¦ï¼Œä»¥å¤šç¨®é¡è‰²çš„æº«æ³‰å’Œé£²ç”¨æº«æ³‰èåï¼Œè‹¥æ™‚é–“è¨±å¯å¯ä¸€ä½µåƒè§€ï¼ˆå¤šåŠ  30 åˆ†é˜ï¼‰ã€‚</li>
                        </ul>
                    </div>
                    <a href="https://www.google.com/maps/search/?api=1&query=åˆ¥åºœ+æµ·åœ°ç„" target="_blank" class="btn-map">å°èˆªè‡³æµ·åœ°ç„</a>
                    <div class="tags"><span class="tag tag-beppu">åˆ¥åºœåœ°ç„</span><span class="tag tag-spot">æ™¯è§€</span></div>
                </div>
                <div class="event event-meal">
                    <div class="time">13:45</div>
                    <div class="activity">åˆé¤æ™‚æ®µï¼šåœ°ç„å‘¨é‚Šè¼•é£Ÿ/ç§»å‹•ä¸­</div>
                    <div class="desc">
                         <ul style="list-style-type: disc;">
                            <li><b>åœ°ç„è’¸æ–™ç†/æº«æ³‰è›‹ï¼šï¼š</b> åœ¨åœ°ç„å€å¿«é€Ÿè³¼è²·è¼•é£Ÿ (å¦‚æº«æ³‰è›‹æˆ–åœ°ç„è’¸å¸ƒä¸) ç•¶ä½œåˆé¤ã€‚</li>
                            <li><b>å‹•ç‰©åœ’åœ’å…§é¤å»³ï¼šï¼šï¼š</b> è‹¥åœ¨åœ°ç„å€æœªç”¨é¤ï¼Œå‰‡ç›´æ¥å‰å¾€å‹•ç‰©åœ’åœ¨åœ’å…§ç”¨é¤ã€‚</li>
                        </ul>
                    </div>
                     <div class="tags"><span class="tag tag-food">é¸æ“‡åˆé¤</span></div>
                </div>
                <div class="event">
                    <div class="time">14:30</div>
                    <div class="activity">æŠµé” ä¹å·è‡ªç„¶å‹•ç‰©å…¬åœ’ (African Safari)</div>
                    <div class="desc">å¾åœ°ç„å€è‡ªé§•ç´„ 15-20 åˆ†é˜å¯æŠµé”ã€‚åœè»Šå ´å¾ˆå¤§ï¼Œè«‹ç•™æ„è·¯æ¨™ã€‚</div>
                    <a href="https://www.google.com/maps/search/?api=1&query=African+Safari+Oita" target="_blank" class="btn-map">å°èˆª</a>
                    <div class="tags"><span class="tag tag-move">æŠµé”</span></div>
                </div>
                <div class="event">
                    <div class="time">14:30 - 17:30</div>
                    <div class="activity">ä¹å·è‡ªç„¶å‹•ç‰©å…¬åœ’ (3å°æ™‚éŠç©)</div>
                    <div class="desc">
                        **æ™‚é–“å»ºè­°ï¼š** è‡ªé§•è§€è³ (30åˆ†é˜) + å¢æ—å·´å£« (50åˆ†é˜) + è¦ªè¿‘å€ (1å°æ™‚30åˆ†é˜)ã€‚
                        **è«‹å‹™å¿…ææ—©é ç´„å¢æ—å·´å£«å ´æ¬¡ï¼Œä¸¦å®‰æ’åœ¨ 15:00 å·¦å³é–‹å§‹ã€‚** è©³æƒ…è«‹è¦‹ã€Œæ—…éŠè³‡è¨Šã€é ç±¤ã€‚
                    </div>
                    <button class="btn-ai-guide" onclick="askGeminiGuide('ä¹å·è‡ªç„¶å‹•ç‰©å…¬åœ’', 'è«‹ç”¨èª‡å¼µæœ‰è¶£çš„èªæ°£ï¼Œå‘Šè¨´å­©å­ç­‰ä¸€ä¸‹æœƒçœ‹åˆ°ç…å­è€è™å°±åœ¨è»Šå­æ—é‚Šï¼Œä¸¦æé†’ä»–å€‘è¦æ³¨æ„çœ‹ä»€éº¼å‹•ç‰©çš„ç‰™é½’ã€‚')">
                        âœ¨ å•Ÿå‹•æ¢éšªæ¨¡å¼
                    </button>
                    <div class="tags"><span class="tag tag-kids">è¦ªå­å¿…éŠ</span><span class="tag tag-spot">å‹•ç‰©åœ’</span></div>
                </div>
                <div class="event">
                    <div class="time">17:30</div>
                    <div class="activity">å‰å¾€ç”±å¸ƒé™¢æº«æ³‰ (å±±ç‡ˆé¤¨)</div>
                    <div class="desc">è»Šç¨‹ç´„ 40åˆ†é˜ï¼Œå¤©è‰²å·²æš—ï¼Œè«‹å°å¿ƒé§•é§›ã€‚</div>
                    <a href="https://www.google.com/maps/search/?api=1&query=Yufuin+Santoukan" target="_blank" class="btn-map">å°èˆªè‡³å±±ç‡ˆé¤¨</a>
                    <div class="tags"><span class="tag tag-move">ç§»å‹•</span><span class="tag tag-stay">ä½å®¿ç¢ºèª</span></div>
                </div>
                <div class="event event-meal">
                    <div class="time">18:30</div>
                    <div class="activity">æ™šé¤: æ—…é¤¨æœƒå¸­æ–™ç†</div>
                    <div class="desc">ç”±å¸ƒé™¢æ—…é¤¨è²»ç”¨é€šå¸¸åŒ…å«ç²¾ç·»çš„æ—¥å¼æœƒå¸­æ™šé¤ï¼Œè«‹ç›¡æƒ…äº«å—ï¼</div>
                    <div class="tags"><span class="tag tag-stay">æº«æ³‰æ—…é¤¨</span><span class="tag tag-food">å·²åŒ…å«</span></div>
                </div>
                <div class="event">
                    <div class="time">20:30</div>
                    <div class="activity">ç”±å¸ƒé™¢æº«æ³‰å€ æ‚ é–’æ•£æ­¥</div>
                    <div class="desc">
                        æ¹¯ä¹‹åªè¡—é“åº—å®¶å¤šå·²æ‰“çƒŠï¼Œä½†å¤œæ™šçš„ç”±å¸ƒé™¢å®‰éœä¸”æ˜Ÿç©ºæ¸…æ™°ã€‚å¯æ•£æ­¥è‡³é‡‘é±—æ¹–æ¬£è³å¤œè‰²ï¼Œæˆ–åœ¨æ—…é¤¨ä¼‘æ¯ã€‚
                    </div>
                    <a href="https://www.google.com/maps/search/?api=1&query=Kinrin+Lake" target="_blank" class="btn-map">é‡‘é±—æ¹–æ–¹å‘å°èˆª</a>
                    <div class="tags"><span class="tag tag-relax">æ”¾é¬†</span></div>
                </div>
            </div>
        </div>

        <!-- Day 4 -->
        <div class="day-wrapper">
            <div class="day-toggle" id="toggle-d4" onclick="toggleTimeline('d4', this)">
                <div class="day-info">
                    <h3>Day 4: ç”±å¸ƒé™¢è‡³ç¦å²¡</h3>
                    <span>1/28 (ä¸‰) â€¢ ä½å®¿: ç¦å²¡</span>
                </div>
                <div class="toggle-icon">â–¼</div>
            </div>
            <div id="d4" class="timeline">
                <div class="event event-meal">
                    <div class="time">08:00</div>
                    <div class="activity">æ—©é¤: æ—…é¤¨å…§äº«ç”¨</div>
                    <div class="desc">äº«ç”¨ç”±å¸ƒé™¢æ—…é¤¨çš„è±ç››æ—©é¤ã€‚</div>
                    <div class="tags"><span class="tag tag-stay">æ—…é¤¨</span><span class="tag tag-food">å·²åŒ…å«</span></div>
                </div>
                <div class="event">
                    <div class="time">09:30</div>
                    <div class="activity">é‡‘é±—æ¹– & æ¹¯ä¹‹åªè¡—é“</div>
                    <div class="desc">æ™¨éœ§ç¾æ™¯ï¼Œè¡—é“ä¸Šæœ‰å²åŠªæ¯”èŒ¶å±‹ã€MiffyéºµåŒ…åº—ã€‚</div>
                    <a href="https://www.google.com/maps/search/?api=1&query=Kinrin+Lake" target="_blank" class="btn-map">å°èˆª</a>
                    <div class="tags"><span class="tag tag-kids">å¥½é€›</span></div>
                </div>
                
                <!-- COMICO ART MUSEUM INSERTED HERE -->
                <div class="event">
                    <div class="time">11:00</div>
                    <div class="activity">COMICO ART MUSEUM YUFUIN</div>
                    <div class="desc">
                        ç”±éšˆç ”å¾è¨­è¨ˆçš„ç¾ä»£ç¾è¡“é¤¨ï¼Œå±•å‡ºè‰é–“å½Œç”Ÿç­‰å¤§å¸«ä½œå“ï¼Œå»ºç¯‰èˆ‡ç”±å¸ƒå²³æ™¯è§€èåˆï¼Œéå¸¸å€¼å¾—ä¸€è¨ªã€‚
                        <span style="display:block; font-size: 0.8rem; color: #666; margin-top: 5px;">*å»ºè­°äº‹å…ˆä¸Šç¶²é ç´„è³¼ç¥¨ã€‚</span>
                    </div>
                    <a href="https://www.google.com/maps/search/?api=1&query=COMICO+ART+MUSEUM+YUFUIN" target="_blank" class="btn-map">å°èˆª</a>
                    <div class="tags"><span class="tag tag-spot">è—è¡“</span><span class="tag tag-spot">å»ºç¯‰</span></div>
                </div>

                <div class="event event-meal">
                    <div class="time">12:30</div>
                    <div class="activity">åˆé¤æ™‚æ®µï¼šç”±å¸ƒé™¢å¿…åƒé‡œé£¯</div>
                    <div class="desc">
                        <ul style="list-style-type: disc;">
                            <li><b>ç”±å¸ƒã¾ã¶ã— å¿ƒ (ç”±å¸ƒé‡œé£¯)ï¼šï¼š</b> è¶…äººæ°£æ’éšŠååº—ï¼Œæ¨è–¦è±å¾Œç‰›é‡œé£¯æˆ–åœ°é›é‡œé£¯ï¼Œä¸€é‹ä¸‰åƒï¼ˆåŸå‘³ã€åŠ ä½æ–™ã€èŒ¶æ³¡é£¯ï¼‰ã€‚å»ºè­°æå‰æ’éšŠæˆ–é¿é–‹å°–å³°ã€‚</li>
                            <li><b>æ¹¯ä¹‹åªè¡—é“å°åƒï¼šï¼š</b> è‹¥ä¸æƒ³ä¹…å€™ï¼Œå¯é¸æ“‡æ²¿è¡—åƒè±å¾Œç‰›ä¸²ç‡’ã€å¯æ¨‚é¤…ç­‰ã€‚</li>
                        </ul>
                    </div>
                    <a href="https://www.google.com/maps/search/?api=1&query=Yufu+Mabushi+Shin" target="_blank" class="btn-map">å°èˆªè‡³ç”±å¸ƒé‡œé£¯</a>
                    <div class="tags"><span class="tag tag-food">é¸æ“‡åˆé¤</span><span class="tag tag-spot">æ’éšŠç¾é£Ÿ</span></div>
                </div>
                <div class="event">
                    <div class="time">13:30</div>
                    <div class="activity">å‰å¾€ç¦å²¡å¸‚å€ (é–‹å§‹ç§»å‹•)</div>
                    <div class="desc">è¸ä¸Šå›ç¦å²¡çš„æ­¸é€”ï¼Œç¸½è»Šç¨‹ç´„ 2.5å°æ™‚ã€‚</div>
                    <div class="tags"><span class="tag tag-move">ç§»å‹•</span></div>
                </div>
                
                <!-- NEW STOP: YAMADA SA -->
                <div class="event">
                    <div class="time">14:40</div>
                    <div class="activity">ä¸­é€”ä¼‘æ¯ï¼šå±±ç”°æœå‹™å€ (Yamada SA)</div>
                    <div class="desc">
                        ä½æ–¼é«˜é€Ÿå…¬è·¯ä¸Šçš„å¤§å‹ä¼‘æ¯ç«™ï¼Œç’°å¢ƒå„ªç¾ï¼Œæœ‰éºµåŒ…åº—ã€è¾²ç”¢å“å’Œä¹¾æ·¨çš„æ´—æ‰‹é–“ã€‚é©åˆåœè»Šè®“å­©å­æ´»å‹•ç­‹éª¨ã€‚
                        <span style="display:block; font-size: 0.8rem; color: #666; margin-top: 5px;">*åœç•™ç´„ 20 åˆ†é˜ã€‚</span>
                    </div>
                    <a href="https://www.google.com/maps/search/?api=1&query=Yamada+Service+Area+Up+Line" target="_blank" class="btn-map">å°èˆªè‡³å±±ç”°SA</a>
                    <div class="tags"><span class="tag tag-relax">ä¼‘æ¯ç«™</span><span class="tag tag-food">è£œçµ¦</span></div>
                </div>
                
                <!-- èª¿æ•´çš„é‚„è»Šè¡Œç¨‹ -->
                <div class="event">
                    <div class="time">16:10</div>
                    <div class="activity">å¸‚å€åŠ æ²¹ (é‚„è»Šå‰æ»¿æ²¹)</div>
                    <div class="desc">
                        ä¾è¦å®šéœ€åŠ æ»¿æ²¹é‚„è»Šã€‚å»ºè­°å‰å¾€é™„è¿‘çš„åŠ æ²¹ç«™ã€‚
                    </div>
                    <a href="https://www.google.com/maps/search/gas+station+near+Toyota+Rent+a+Car+Hakata+Station+Hakata+Exit" target="_blank" class="btn-map">æœå°‹é™„è¿‘åŠ æ²¹ç«™</a>
                    <div class="tags"><span class="tag tag-car">åŠ æ²¹</span></div>
                </div>
                <div class="event">
                    <div class="time">16:30</div>
                    <div class="activity">æ­¸é‚„ç§Ÿè³ƒè»Šè¼› (Toyota åšå¤šé§…åšå¤šå£åº—)</div>
                    <div class="desc">
                        <b>é‚„è»Šé»ï¼š</b> Toyota Rent a Car åšå¤šé§…åšå¤šå£åº—ã€‚<br>
                        è«‹å‹™å¿…æ”œå¸¶åŠ æ²¹æ”¶æ“šä»¥ä¾›æŸ¥é©—ã€‚
                    </div>
                    <a href="https://www.google.com/maps/search/?api=1&query=Toyota+Rent+a+Car+Hakata+Station+Hakata+Exit" target="_blank" class="btn-map">å°èˆªè‡³é‚„è»Šé»</a>
                    <div class="tags"><span class="tag tag-move">é‚„è»Š</span></div>
                </div>
                <!-- èª¿æ•´çµæŸ -->
                <div class="event">
                    <div class="time">18:00</div>
                    <div class="activity">é£¯åº— Check-in</div>
                    <div class="desc">æ—¥èˆªè¥¿éµ æˆ– ä¼‘é›·å…‹è“‹ç‰¹ã€‚</div>
                    <div class="tags"><span class="tag tag-stay">å¸‚å€é£¯åº—</span></div>
                </div>
                <div class="event event-meal">
                    <div class="time">20:00</div>
                    <div class="activity">æ™šé¤æ™‚æ®µï¼šç¦å²¡åœ¨åœ°ç¾é£Ÿé¸æ“‡</div>
                    <div class="desc">
                        <ul style="list-style-type: disc;">
                            <li><b>åšå¤šç‰›è…¸é‹ (ã‚‚ã¤é‹)ï¼šï¼š</b> å†¬å¤©å¿…åƒï¼Œæš–èƒƒã€‚å¯é¸åšå¤šç«™é™„è¿‘çŸ¥ååº—å®¶ã€‚</li>
                            <li><b>åšå¤šæ‹‰éºµï¼šï¼šï¼š</b> ä¸€è˜­æˆ–ä¸€é¢¨å ‚æœ¬åº—éƒ½åœ¨ç¦å²¡ã€‚</li>
                        </ul>
                    </div>
                    <div class="tags"><span class="tag tag-food">é¸æ“‡æ™šé¤</span></div>
                </div>
                <div class="event">
                    <div class="time">21:30</div>
                    <div class="activity">åšå¤šç«™å‘¨é‚Š å¤œé–“æ•£æ­¥/è£œè²¨</div>
                    <div class="desc">
                        é‚„è»Šå¾Œè¼•é¬†æ­ä¹˜å¤§çœ¾äº¤é€šå·¥å…·ã€‚å¯å‰å¾€åšå¤šé‹æ²³åŸï¼ˆæ°´èˆç§€ï¼‰æˆ–åœ¨é£¯åº—å‘¨é‚Šè—¥å¦åº—è£œçµ¦ã€‚
                    </div>
                    <a href="https://www.google.com/maps/search/?api=1&query=Canal+City+Hakata" target="_blank" class="btn-map">é‹æ²³åŸå°èˆª</a>
                    <div class="tags"><span class="tag tag-kids">è³¼ç‰©</span><span class="tag tag-spot">å¤œæ™¯</span></div>
                </div>
            </div>
        </div>

        <!-- Day 5 -->
        <div class="day-wrapper">
            <div class="day-toggle" id="toggle-d5" onclick="toggleTimeline('d5', this)">
                <div class="day-info">
                    <h3>Day 5: å¤ªå®°åºœèˆ‡ç¦å²¡è³¼ç‰©</h3>
                    <span>1/29 (å››) â€¢ ä½å®¿: ç¦å²¡</span>
                </div>
                <div class="toggle-icon">â–¼</div>
            </div>
            <div id="d5" class="timeline">
                <div class="event event-meal">
                    <div class="time">09:00</div>
                    <div class="activity">æ—©é¤: é£¯åº—æˆ–åšå¤šç«™å…§</div>
                    <div class="desc">å¯æ–¼é£¯åº—äº«ç”¨ï¼Œæˆ–åœ¨åšå¤šç«™å…§é¸è³¼æ—¥å¼æ—©é¤æˆ–éºµåŒ…ã€‚</div>
                     <div class="tags"><span class="tag tag-food">é¸æ“‡æ—©é¤</span></div>
                </div>
                <div class="event">
                    <div class="time">09:30</div>
                    <div class="activity">å¤ªå®°åºœå¤©æ»¿å®®</div>
                    <div class="desc">æ­è¥¿éµå‰å¾€ã€‚å¿…åƒæ¢…æé¤…ï¼Œåƒè§€è¡¨åƒé“æ˜Ÿå·´å…‹ã€‚</div>
                    <a href="https://www.google.com/maps/search/?api=1&query=Dazaifu+Tenmangu" target="_blank" class="btn-map">å°èˆª</a>
                </div>
                <div class="event event-meal">
                    <div class="time">12:30</div>
                    <div class="activity">åˆé¤æ™‚æ®µï¼šå¤ªå®°åºœå‘¨é‚Šé¸æ“‡</div>
                    <div class="desc">
                        <ul style="list-style-type: disc;">
                            <li><b>æ¢…æé¤…ï¼šï¼š</b> å¯ç•¶é»å¿ƒã€‚</li>
                            <li><b>å¤ªå®°åºœé£Ÿå ‚ï¼šï¼š</b> è¡¨åƒé“ä¸Šæœ‰å¤šå®¶çƒé¾éºµã€å®šé£Ÿé¤å»³ã€‚</li>
                        </ul>
                    </div>
                    <div class="tags"><span class="tag tag-food">é¸æ“‡åˆé¤</span></div>
                </div>
                <div class="event">
                    <div class="time">14:30</div>
                    <div class="activity">ä¹å·åœ‹ç«‹åšç‰©é¤¨</div>
                    <div class="desc">ä½æ–¼å¤ªå®°åºœæ—ï¼Œå£¯è§€çš„å»ºç¯‰èˆ‡å±•è¦½ã€‚</div>
                </div>
                <!-- å‚™æ¡ˆ -->
                <div class="event">
                    <div class="time">å‚™æ¡ˆ</div>
                    <div class="activity">ç¦å²¡éºµåŒ…è¶…äººå…’ç«¥åšç‰©é¤¨ (é›¨å¤©é¦–é¸)</div>
                    <div class="desc">
                        ä½æ–¼åšå¤šæ²³ç•”åŸ (Hakata Riverain) 5-6æ¨“ï¼Œèˆ‡åœ°éµã€Œä¸­æ´²å·ç«¯ã€ç«™ç›´çµã€‚
                        å®Œå…¨å®¤å…§ï¼Œé©åˆå­¸é½¡å‰å…’ç«¥æ”¾é›»ã€‚
                        <span style="display:block; font-size: 0.8rem; color: #666; margin-top: 5px;">*è©³æƒ…è«‹è¦‹ã€Œæ—…éŠè³‡è¨Šã€é ç±¤ã€‚</span>
                    </div>
                    <a href="https://www.google.com/maps/search/?api=1&query=Fukuoka+Anpanman+Children's+Museum" target="_blank" class="btn-map">å°èˆª</a>
                    <div class="tags"><span class="tag tag-kids">è¦ªå­å¿…éŠ</span><span class="tag tag-spot">å®¤å…§</span></div>
                </div>
                <!-- å‚™æ¡ˆçµæŸ -->

                <div class="event">
                    <div class="time">17:00</div>
                    <div class="activity">åšå¤šé‹æ²³åŸ / æ«›ç”°ç¥ç¤¾</div>
                    <div class="desc">è³¼ç‰©ä¸­å¿ƒæœ‰æ°´èˆç§€ (æ•´é»)ã€‚</div>
                    <div class="tags"><span class="tag tag-spot">è³¼ç‰©</span></div>
                </div>
                <div class="event event-meal">
                    <div class="time">20:00</div>
                    <div class="activity">æ™šé¤æ™‚æ®µï¼šå±‹å°é«”é©—æˆ–è³¼ç‰©ä¸­å¿ƒ</div>
                    <div class="desc">
                        <ul style="list-style-type: disc;">
                            <li><b>ä¸­æ´²å±‹å°ï¼šï¼š</b> é«”é©—ç¦å²¡çš„è·¯é‚Šæ”¤æ–‡åŒ– (è¦ªå­éœ€æ³¨æ„ç’°å¢ƒ)ã€‚</li>
                            <li><b>é‹æ²³åŸå…§é¤å»³ï¼šï¼šï¼š</b> é¸æ“‡å¤šæ¨£ï¼Œç”¨é¤ç’°å¢ƒè¼ƒèˆ’é©ã€‚</li>
                        </ul>
                    </div>
                    <a href="https://www.google.com/maps/search/?api=1&query=Nakasu+Yatai" target="_blank" class="btn-map">å±‹å°å°èˆª</a>
                    <div class="tags"><span class="tag tag-food">é¸æ“‡æ™šé¤</span></div>
                </div>
                <div class="event">
                    <div class="time">21:30</div>
                    <div class="activity">æœ€çµ‚è£œçµ¦èˆ‡å›æˆ¿æ•´ç†</div>
                    <div class="desc">
                        åœ¨ç¦å²¡å¸‚å€æ¡è²·æœ€å¾Œçš„ä¼´æ‰‹ç¦®å’Œè—¥å¦ï¼Œä¸¦æå‰æ•´ç†è¡Œæã€‚
                    </div>
                    <div class="tags"><span class="tag tag-kids">è³¼ç‰©</span><span class="tag tag-relax">æº–å‚™è¿”ç¨‹</span></div>
                </div>
            </div>
        </div>

        <!-- Day 6 -->
        <div class="day-wrapper">
            <div class="day-toggle" id="toggle-d6" onclick="toggleTimeline('d6', this)">
                <div class="day-info">
                    <h3>Day 6: è³¼ç‰©èˆ‡è¿”ç¨‹</h3>
                    <span>1/30 (äº”) â€¢ æº«æš–çš„å®¶</span>
                </div>
                <div class="toggle-icon">â–¼</div>
            </div>
            <div id="d6" class="timeline">
                <div class="event event-meal">
                    <div class="time">09:00</div>
                    <div class="activity">æ—©é¤: é£¯åº—æˆ–åšå¤šç«™å…§</div>
                    <div class="desc">æœ€å¾Œä¸€å€‹æ—©æ™¨ï¼Œè¼•é¬†ç”¨é¤ã€‚</div>
                     <div class="tags"><span class="tag tag-food">é¸æ“‡æ—©é¤</span></div>
                </div>
                <div class="event">
                    <div class="time">10:00</div>
                    <div class="activity">å‰å¾€ LaLaport ç¦å²¡</div>
                    <div class="desc">
                        ç¦å²¡æœ€æ–°å¤§å‹è³¼ç‰©ä¸­å¿ƒï¼Œå¿…çœ‹ <b>1:1 å¯¦é«”å¤§é‹¼å½ˆç«‹åƒ</b>ï¼
                        å•†å ´å…§é‚„æœ‰ KidZania (éœ€é ç´„) å’Œè±å¯Œçš„å…’ç«¥éŠæ¨‚è¨­æ–½ã€‚
                        <span style="display:block; font-size: 0.8rem; color: #666; margin-top: 5px;">*äº¤é€šï¼šå¾åšå¤šç«™æ­ä¹˜å·´å£«æˆ– JR å‰å¾€ç«¹ä¸‹ç«™ã€‚</span>
                    </div>
                    <button class="btn-ai-guide" onclick="askGeminiGuide('RX-93ff Î½é‹¼å½ˆ', 'ç°¡å–®ä»‹ç´¹é€™å€‹å·¨å¤§çš„æ©Ÿå™¨äººæœ‰å¤šé«˜ï¼ˆç”¨å¹¾å±¤æ¨“æ¯”å–»ï¼‰ï¼Œä»¥åŠä»–ç‚ºä»€éº¼è¦ç«™åœ¨é€™è£¡ä¿è­·å¤§å®¶ã€‚')">
                        âœ¨ ä»‹ç´¹å·¨å‹æ©Ÿå™¨äºº
                    </button>
                     <a href="https://www.google.com/maps/search/?api=1&query=LaLaport+Fukuoka" target="_blank" class="btn-map">å°èˆªè‡³ LaLaport</a>
                    <div class="tags"><span class="tag tag-spot">é‹¼å½ˆ</span><span class="tag tag-kids">è¦ªå­å¿…éŠ</span><span class="tag tag-shop">è³¼ç‰©</span></div>
                </div>
                <div class="event event-meal">
                    <div class="time">12:30</div>
                    <div class="activity">åˆé¤æ™‚æ®µï¼šLaLaport ç¾é£Ÿè¡—</div>
                    <div class="desc">
                        ç¾é£Ÿè¡—é¸æ“‡éå¸¸å¤šæ¨£ï¼Œæœ‰ä¹å·åœ¨åœ°ç¾é£Ÿä¹Ÿæœ‰çŸ¥åé€£é–åº—ï¼Œç’°å¢ƒå¯¬æ•é©åˆè¦ªå­ã€‚
                    </div>
                    <div class="tags"><span class="tag tag-food">é¸æ“‡åˆé¤</span></div>
                </div>
                <div class="event">
                    <div class="time">14:30</div>
                    <div class="activity">è¿”å›åšå¤šç«™ & AMU PLAZA ä¼´æ‰‹ç¦®æ¡è²·</div>
                    <div class="desc">
                         å›åˆ°åšå¤šç«™é ˜å–è¡Œæå‰ï¼Œå‹™å¿…åœ¨ **AMU PLAZA** æˆ– **Ming** å•†åº—è¡—æ¡è³¼æœ€å¾Œçš„ä¼´æ‰‹ç¦®ï¼(è©³è¦‹æ—…éŠè³‡è¨Š)
                    </div>
                    <a href="https://www.google.com/maps/search/?api=1&query=AMU+PLAZA+Hakata" target="_blank" class="btn-map">å°èˆªè‡³ AMU PLAZA</a>
                    <div class="tags"><span class="tag tag-shop">ä¼´æ‰‹ç¦®</span><span class="tag tag-move">ç§»å‹•</span></div>
                </div>
                <div class="event">
                    <div class="time">16:00</div>
                    <div class="activity">å‰å¾€ç¦å²¡æ©Ÿå ´ (FUK)</div>
                    <div class="desc">æ­ä¹˜åœ°éµç©ºæ¸¯ç·šï¼Œç´„ 5-10 åˆ†é˜å³å¯æŠµé”æ©Ÿå ´ã€‚</div>
                </div>
                <div class="event">
                    <div class="time">19:10</div>
                    <div class="activity">ç­æ©Ÿèµ·é£›</div>
                    <div class="desc">æ˜Ÿå®‡èˆªç©º å¾€å°åŒ— (TPE)ã€‚</div>
                    <div class="tags"><span class="tag tag-move">è¿”ç¨‹</span></div>
                </div>
            </div>
        </div>
    </div>

    <!-- TAB 5: AI åŠ©æ‰‹ (New Integrated Page) -->
    <div id="view-ai" class="container">
        <div class="card" style="min-height: 600px; display: flex; flex-direction: column;">
            <div class="ai-header" id="ai-modal-title">
                <span>âœ¨ éš¨èº« AI ç¿»è­¯èˆ‡åŠ©æ‰‹</span>
            </div>
            
            <div class="ai-result-box" id="ai-result" style="flex: 1;">
                <div style="color: #4B5563; font-size: 1rem; line-height: 1.6;">
                    ä½ å¥½ï¼æˆ‘æ˜¯ä½ çš„ä¹å·æ—…éŠ AI åŠ©æ‰‹ã€‚<br><br>
                    <b>è«‹é¸æ“‡ä¸‹æ–¹åŠŸèƒ½æŒ‰éµï¼š</b>
                    <br>
                    <svg class="inline-icon icon-consult" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"></circle><polygon points="16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76"></polygon></svg> 
                    <b>è¡Œç¨‹è«®è©¢ï¼š</b> è©¢å•è·¯ç·šã€æ™‚é–“æˆ–æ™¯é»å»ºè­°ã€‚
                    <br>
                    <svg class="inline-icon icon-trans" viewBox="0 0 24 24"><path d="M7 10h14"></path><path d="M17 6l4 4-4 4"></path><path d="M17 14H3"></path><path d="M7 18l-4-4 4-4"></path></svg> 
                    <b>ä¸­/æ—¥ç¿»è­¯ï¼š</b> è¼¸å…¥æ–‡å­—é€²è¡Œé›™å‘ç¿»è­¯ã€‚
                    <br>
                    <svg class="inline-icon" style="color: #06B6D4;" viewBox="0 0 24 24"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="23"></line><line x1="8" y1="23" x2="16" y2="23"></line></svg>
                    <b>è½æ—¥èªï¼š</b> <b>æŒ‰ä½</b>è®“æ—¥æœ¬äººèªªè©±ï¼Œç¿»è­¯æˆä¸­æ–‡ã€‚
                </div>
            </div>

            <div class="ai-input-group" id="ai-input-area" style="display: block; margin-top: auto;">
                <div class="ai-input-wrapper">
                    <input type="text" class="ai-input" id="ai-user-input" placeholder="è«‹è¼¸å…¥å…§å®¹..." onkeypress="handleEnter(event)">
                    <div class="ai-actions-row">
                        <button class="btn-mode consult" onclick="sendToGemini('consult')">
                            <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"></circle><polygon points="16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76"></polygon></svg>
                            è¡Œç¨‹è«®è©¢
                        </button>
                        <button class="btn-mode trans" onclick="sendToGemini('translate')">
                            <svg viewBox="0 0 24 24"><path d="M7 10h14"></path><path d="M17 6l4 4-4 4"></path><path d="M17 14H3"></path><path d="M7 18l-4-4 4-4"></path></svg>
                            ä¸­/æ—¥ç¿»è­¯
                        </button>
                        <!-- New Voice Button (Press and Hold) -->
                        <button class="btn-mode voice" id="btn-voice-ja">
                            <svg viewBox="0 0 24 24"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="23"></line><line x1="8" y1="23" x2="16" y2="23"></line></svg>
                            è½æ—¥èª
                        </button>
                    </div>
                </div>
            </div>
            <!-- Back button for specific guide mode -->
            <button id="btn-back-trans" class="btn-ai-reset" onclick="showAiTranslatorMode()">
                 â†©ï¸ è¿”å›ä¸€èˆ¬æ¨¡å¼
            </button>
        </div>
    </div>

    <!-- Bottom Navigation Bar (5 items) -->
    <nav class="nav-bar">
        <div class="nav-item active" data-target="view-schedule" onclick="switchTab(this)">
            <span class="nav-icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
            </span>
            è¡Œç¨‹è¡¨
        </div>
        <div class="nav-item" data-target="view-stay" onclick="switchTab(this)">
            <span class="nav-icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M2 22v-8c0-1.1.9-2 2-2h4v10H4c-1.1 0-2-.9-2-2zM22 22v-8c0-1.1-.9-2-2-2h-4v10h4c1.1 0 2-.9 2-2zM12 2L2 12h3v8h4v-6h6v6h4v-8h3L12 2z"></path></svg>
            </span>
            ä½å®¿è³‡è¨Š
        </div>
        <div class="nav-item" data-target="view-car" onclick="switchTab(this)">
            <span class="nav-icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2"/><circle cx="7" cy="17" r="2"/><circle cx="17" cy="17" r="2"/><path d="M5 17h2"/><path d="M15 17h2"/></svg>
            </span>
            äº¤é€šè³‡è¨Š
        </div>
        <div class="nav-item" data-target="view-info" onclick="switchTab(this)">
            <span class="nav-icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15 14c.2-1 .7-1.7 1.5-2.5 1-1 1.5-2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5"/><path d="M9 18h6"/><path d="M10 22h4"/></svg>
            </span>
            æ—…éŠè³‡è¨Š
        </div>
        <div class="nav-item" data-target="view-ai" onclick="switchTab(this)">
            <span class="nav-icon" style="color: #3b82f6;">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path></svg>
            </span>
            AI åŠ©æ‰‹
        </div>
    </nav>

    <script>
        // API Configuration
        const encodedKey = "QUl6YVN5QUVhODNFazVFczV6N1RoV0U5Nk50SGF4TUNQeXpUMDhj"; 
        const apiKey = atob(encodedKey);


        // Weather Data Configuration
        // Icons: Using simple SVG strings for white icons
        const weatherIcons = {
            'sun': '<svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>',
            'cloud': '<svg viewBox="0 0 24 24"><path d="M18 10h-1.26A8 8 0 1 0 9 20h9a5 5 0 0 0 0-10z"></path></svg>',
            'cloud-sun': '<svg viewBox="0 0 24 24"><path d="M12 2v2"></path><path d="m4.93 4.93 1.41 1.41"></path><path d="M20 12h2"></path><path d="m19.07 4.93-1.41 1.41"></path><path d="M15.947 12.65a4 4 0 0 0-5.925-4.128"></path><path d="M13 22H7a5 5 0 1 1 4.9-6H13a3 3 0 0 1 0 6Z"></path></svg>',
            'rain': '<svg viewBox="0 0 24 24"><path d="M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242"></path><path d="M16 14v6"></path><path d="M8 14v6"></path><path d="M12 16v6"></path></svg>',
            'snow': '<svg viewBox="0 0 24 24"><path d="M4.5 10H4a7 7 0 1 1 7-7v.5"></path><path d="M10 14a6 6 0 0 0-6-6"></path><line x1="12" y1="16" x2="12" y2="22"></line><line x1="12" y1="22" x2="9" y2="19"></line><line x1="12" y1="22" x2="15" y2="19"></line><line x1="18.5" y1="12" x2="22" y2="12"></line><line x1="22" y1="12" x2="19.5" y2="9.5"></line><line x1="22" y1="12" x2="19.5" y2="14.5"></line><line x1="5" y1="18.5" x2="2" y2="18.5"></line><line x1="2" y1="18.5" x2="4.5" y2="21"></line><line x1="2" y1="18.5" x2="4.5" y2="16"></line><line x1="17.5" y1="18.5" x2="20.5" y2="21"></line><line x1="17.5" y1="18.5" x2="20.5" y2="16"></line></svg>'
        };

        const weatherData = {
            'd1': { loc: 'ç†Šæœ¬å¸‚', date: '1/25 (Day 1)', temp: '10Â°C', range: '2Â°C ~ 11Â°C', desc: 'æ™´æ™‚å¤šé›²', advice: 'æ°£æº«é©ä¸­ä½†æ—©æ™šåæ¶¼ï¼Œé•·è¢–é…å¤–å¥—ã€‚', icon: 'cloud-sun' },
            'd2': { loc: 'é˜¿è˜‡/é»‘å·', date: '1/26 (Day 2)', temp: '5Â°C', range: '-3Â°C ~ 6Â°C', desc: 'å¤šé›²/é£„é›ª', advice: 'å±±å€æ¥µå†·ï¼Œå‹™å¿…ç©¿è‘—ç¾½çµ¨å¤–å¥—ä¿æš–ã€‚', icon: 'snow' },
            'd3': { loc: 'åˆ¥åºœ/ç”±å¸ƒé™¢', date: '1/27 (Day 3)', temp: '7Â°C', range: '0Â°C ~ 8Â°C', desc: 'å¤šé›²', advice: 'æ¿•åº¦è¼ƒé«˜é«”æ„Ÿå¯’å†·ï¼Œè«‹ç©¿é˜²æ»‘é‹ã€‚', icon: 'cloud' },
            'd4': { loc: 'ç¦å²¡å¸‚', date: '1/28 (Day 4)', temp: '9Â°C', range: '4Â°C ~ 10Â°C', desc: 'é™°å¤©', advice: 'å¸‚å€é¢¨å¤§ï¼Œå»ºè­°ç©¿è‘—é˜²é¢¨å¤–å¥—ã€‚', icon: 'cloud' },
            'd5': { loc: 'ç¦å²¡å¸‚', date: '1/29 (Day 5)', temp: '10Â°C', range: '3Â°C ~ 11Â°C', desc: 'æ™´æœ—', advice: 'æ—©æ™šæº«å·®å¤§ï¼Œæ´‹è”¥å¼ç©¿æ³•æœ€ä½³ã€‚', icon: 'sun' },
            'd6': { loc: 'ç¦å²¡å¸‚', date: '1/30 (Day 6)', temp: '9Â°C', range: '4Â°C ~ 10Â°C', desc: 'å¤šé›²æ™‚æ™´', advice: 'å®¤å…§æš–æ°£å¼·ï¼Œå…§æ­ä¸å®œéåšã€‚', icon: 'cloud-sun' }
        };

        function updateWeatherWidget(dayId) {
            const data = weatherData[dayId];
            if (data) {
                document.getElementById('hw-loc').innerText = data.loc;
                document.getElementById('hw-date').innerText = data.date;
                document.getElementById('hw-temp').innerText = data.temp; 
                document.getElementById('hw-desc').innerText = data.desc;
                document.getElementById('hw-range').innerText = data.range;
                document.getElementById('hw-advice').innerText = data.advice;
                
                // Update Icon
                const iconSvg = weatherIcons[data.icon] || weatherIcons['cloud'];
                // Wrap in svg tag with stroke/fill settings
                const fullSvg = `<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">${iconSvg.replace('<svg viewBox="0 0 24 24">', '').replace('</svg>', '')}</svg>`;
                document.getElementById('hw-icon').innerHTML = fullSvg;
            }
        }

        // Updated safe switchTab function
        function switchTab(element) {
            // Safety check: if element is null or undefined, stop here to prevent error
            if (!element) return;

            // Remove active from all nav items
            document.querySelectorAll('.nav-item').forEach(item => {
                if (item && item.classList) item.classList.remove('active');
            });

            // Remove active from all containers
            document.querySelectorAll('.container').forEach(container => {
                if (container && container.classList) container.classList.remove('active');
            });

            // Activate clicked item
            if (element.classList) {
                element.classList.add('active');
            }

            // Activate target content
            const targetId = element.getAttribute('data-target');
            if (targetId) {
                const targetContent = document.getElementById(targetId);
                if (targetContent && targetContent.classList) {
                    targetContent.classList.add('active');
                }
            }
            
            window.scrollTo(0, 0);
        }

        function toggleTimeline(id, toggleElement) {
            const timeline = document.getElementById(id);
            if (!timeline) return; // Safety check

            // If opening a new day
            if (!timeline.classList.contains('show')) {
                // Collapse others
                document.querySelectorAll('.timeline.show').forEach(t => t.classList.remove('show'));
                document.querySelectorAll('.day-toggle.open').forEach(t => t.classList.remove('open'));
                
                // Show target
                timeline.classList.add('show');
                toggleElement.classList.add('open');
                
                // Update Weather!
                updateWeatherWidget(id);
            } else {
                // Closing the current day
                timeline.classList.remove('show');
                toggleElement.classList.remove('open');
            }
        }

        // AI Functions
        const aiResult = document.getElementById('ai-result');
        const aiInput = document.getElementById('ai-user-input');
        const aiTitle = document.getElementById('ai-modal-title');
        const aiInputArea = document.getElementById('ai-input-area');
        const btnBackTrans = document.getElementById('btn-back-trans');

        // Function to switch to AI tab programmatically
        function goToAiTab() {
            // Use querySelector safely
            const aiTabBtn = document.querySelector('[data-target="view-ai"]');
            if (aiTabBtn) {
                switchTab(aiTabBtn);
            } else {
                console.error("AI Tab button not found");
            }
        }

        function showAiTranslatorMode() {
            aiTitle.innerHTML = '<span>âœ¨ éš¨èº« AI ç¿»è­¯èˆ‡åŠ©æ‰‹</span>';
            aiResult.innerHTML = `
                <div style="color: #4B5563; font-size: 1rem; line-height: 1.6;">
                    ä½ å¥½ï¼æˆ‘æ˜¯ä½ çš„ä¹å·æ—…éŠ AI åŠ©æ‰‹ã€‚<br><br>
                    <b>è«‹é¸æ“‡ä¸‹æ–¹åŠŸèƒ½æŒ‰éµï¼š</b>
                    <br>
                    <svg class="inline-icon icon-consult" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"></circle><polygon points="16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76"></polygon></svg> 
                    <b>è¡Œç¨‹è«®è©¢ï¼š</b> è©¢å•è·¯ç·šã€æ™‚é–“æˆ–æ™¯é»å»ºè­°ã€‚
                    <br>
                    <svg class="inline-icon icon-trans" viewBox="0 0 24 24"><path d="M7 10h14"></path><path d="M17 6l4 4-4 4"></path><path d="M17 14H3"></path><path d="M7 18l-4-4 4-4"></path></svg> 
                    <b>ä¸­/æ—¥ç¿»è­¯ï¼š</b> è¼¸å…¥æ–‡å­—é€²è¡Œé›™å‘ç¿»è­¯ã€‚
                    <br>
                    <svg class="inline-icon" style="color: #06B6D4;" viewBox="0 0 24 24"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="23"></line><line x1="8" y1="23" x2="16" y2="23"></line></svg>
                    <b>è½æ—¥èªï¼š</b> <b>æŒ‰ä½</b>è®“æ—¥æœ¬äººèªªè©±ï¼Œç¿»è­¯æˆä¸­æ–‡ã€‚
                </div>
            `;
            aiInputArea.style.display = 'block'; 
            btnBackTrans.style.display = 'none';
            aiInput.value = '';
            
            // Re-attach listeners for the new DOM elements
            setupVoiceButton();
        }

        // Voice Recognition Logic
        function setupVoiceButton() {
            const voiceBtn = document.getElementById('btn-voice-ja');
            if (!voiceBtn) return;

            let recognition;
            
            // Feature Detection
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            
            if (!SpeechRecognition) {
                // Not supported (e.g., iOS Safari)
                voiceBtn.classList.add('disabled');
                voiceBtn.innerHTML = `
                   <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>
                   æ‰‹æ©Ÿä¸æ”¯æ´
                `;
                voiceBtn.onclick = () => alert('æ‚¨çš„è£ç½®ï¼ˆå¦‚ iOS Safariï¼‰ä¸æ”¯æ´ç¶²é èªéŸ³è¾¨è­˜åŠŸèƒ½ã€‚');
                return;
            }
            
            // Supported (e.g., Chrome on Android/Desktop)
            recognition = new SpeechRecognition();
            recognition.lang = 'ja-JP'; // Set to Japanese
            recognition.continuous = false;
            recognition.interimResults = false;

            recognition.onstart = function() {
                voiceBtn.classList.add('recording');
                voiceBtn.innerHTML = 'ğŸ”´ æ”¶éŸ³ä¸­...';
                aiInput.placeholder = 'æ­£åœ¨è†è½æ—¥èª...';
            };

            recognition.onend = function() {
                voiceBtn.classList.remove('recording');
                voiceBtn.innerHTML = `
                    <svg viewBox="0 0 24 24" style="width:20px;height:20px;fill:none;stroke:currentColor;stroke-width:2.5;stroke-linecap:round;stroke-linejoin:round;margin-bottom:2px;"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="23"></line><line x1="8" y1="23" x2="16" y2="23"></line></svg>
                    è½æ—¥èª
                `;
                aiInput.placeholder = 'è«‹è¼¸å…¥å…§å®¹...';
            };
            
            recognition.onerror = function(event) {
                console.error("Speech Recognition Error:", event.error);
                let msg = "æ”¶éŸ³å¤±æ•—";
                if (event.error === 'not-allowed') msg = "è«‹å…è¨±éº¥å…‹é¢¨æ¬Šé™";
                if (event.error === 'no-speech') msg = "æ²’è½åˆ°è²éŸ³";
                alert(msg);
                recognition.stop();
            };

            recognition.onresult = function(event) {
                const transcript = event.results[0][0].transcript;
                aiInput.value = transcript;
                // Auto send with 'voice_ja' mode
                sendToGemini('voice_ja');
            };

            // Handling Mouse/Touch Events for "Press and Hold"
            const startRec = (e) => {
                // Prevent context menu on long press
                if (e.type === 'touchstart' || e.type === 'contextmenu') e.preventDefault(); 
                try { recognition.start(); } catch(err) { console.log(err); }
            };
            
            const stopRec = (e) => {
                e.preventDefault();
                try { recognition.stop(); } catch(err) { console.log(err); }
            };

            // Bind events
            voiceBtn.addEventListener('mousedown', startRec);
            voiceBtn.addEventListener('mouseup', stopRec);
            voiceBtn.addEventListener('touchstart', startRec, {passive: false});
            voiceBtn.addEventListener('touchend', stopRec);
            voiceBtn.addEventListener('contextmenu', (e) => e.preventDefault()); // Block right click/long press menu
        }

        function askGeminiGuide(spotName, customPrompt) {
            goToAiTab(); // Switch to the AI tab
            
            aiTitle.innerHTML = `<span>âœ¨ ${spotName} å°æ•…äº‹</span>`;
            aiInputArea.style.display = 'none'; // Hide input for guide mode
            btnBackTrans.style.display = 'block'; // Show back button
            
            const prompt = `
                ä½ æ˜¯ä¸€ä½å¸¶é ˜è¦ªå­æ—…éŠçš„ä¹å·å°éŠã€‚
                è«‹é‡å°æ™¯é»ã€Œ${spotName}ã€ç”Ÿæˆä¸€æ®µçµ¦ 5-8 æ­²å°å­©è½çš„å°è¦½è©ã€‚
                è¦æ±‚ï¼š
                1. èªæ°£ç”Ÿå‹•æ´»æ½‘ï¼Œä½¿ç”¨å°ç£ç¹é«”ä¸­æ–‡ã€‚
                2. å…§å®¹åŒ…å«ä¸€å€‹é—œæ–¼è©²æ™¯é»çš„æœ‰è¶£å†·çŸ¥è­˜ã€‚
                3. çµ¦å­©å­ä¸€å€‹ã€Œå°å°è§€å¯Ÿä»»å‹™ã€ï¼ˆä¾‹å¦‚ï¼šæ‰¾æ‰¾çœ‹æŸå€‹é¡è‰²çš„æ±è¥¿ï¼‰ã€‚
                4. æ•´é«”é•·åº¦æ§åˆ¶åœ¨ 150 å­—ä»¥å…§ã€‚
                5. ${customPrompt}
            `;
            
            callGemini(prompt);
        }

        function handleEnter(e) {
            // If Enter is pressed, use 'auto' mode (legacy behavior)
            if (e.key === 'Enter') sendToGemini('auto');
        }

        function sendToGemini(mode) {
            const text = aiInput.value.trim();
            if (!text) return;

            // 1. æŠ“å–ç›®å‰çš„è¡Œç¨‹è¡¨æ–‡å­—å…§å®¹ (è®“ AI çŸ¥é“æ‚¨çš„è¨ˆç•«)
            const scheduleContext = document.getElementById('view-schedule').innerText;
            
            let prompt = "";

            if (mode === 'consult') {
                // å¼·åˆ¶è¡Œç¨‹è«®è©¢æ¨¡å¼
                prompt = `
                    ä½ æ˜¯ä¸€ä½å°ˆæ¥­çš„ä¹å·è¦ªå­æ—…éŠé¡§å•ã€‚
                    
                    ã€ç›®å‰çš„è¡Œç¨‹è¡¨è³‡è¨Šã€‘ï¼š
                    ${scheduleContext.substring(0, 8000)}

                    ã€ä½¿ç”¨è€…å•é¡Œã€‘ï¼š "${text}"

                    ä»»å‹™ï¼šè«‹æ ¹æ“šè¡Œç¨‹è¡¨ï¼Œé‡å°ä½¿ç”¨è€…çš„å•é¡Œæä¾›å…·é«”ã€å¯¦ç”¨çš„å»ºè­°ã€‚
                    æ³¨æ„ï¼šè€ƒæ…®åˆ°æ˜¯è¦ªå­æ—…éŠï¼Œè«‹æ³¨æ„é«”åŠ›åˆ†é…èˆ‡å…’ç«¥éœ€æ±‚ã€‚
                    è«‹ç”¨å°ç£ç¹é«”ä¸­æ–‡å›ç­”ã€‚
                `;
            } else if (mode === 'translate') {
                // å¼·åˆ¶ç¿»è­¯æ¨¡å¼
                prompt = `
                    ä½ æ˜¯ä¸€å€‹å°ˆæ¥­çš„ä¸­æ—¥ç¿»è­¯æ©Ÿã€‚
                    
                    ã€ä½¿ç”¨è€…è¼¸å…¥ã€‘ï¼š "${text}"

                    ä»»å‹™ï¼š
                    1. è‹¥è¼¸å…¥ä¸­æ–‡ï¼šè«‹ç¿»è­¯æˆè‡ªç„¶çš„æ—¥æ–‡ (ç¦®è²Œå½¢)ã€‚åªè¼¸å‡ºç¿»è­¯å¾Œçš„æ—¥æ–‡ã€‚
                    2. è‹¥è¼¸å…¥æ—¥æ–‡ï¼šè«‹ç¿»è­¯æˆç¹é«”ä¸­æ–‡ã€‚
                    
                    æ³¨æ„ï¼šä¸è¦ä»»ä½•è§£é‡‹ï¼Œåªçµ¦æˆ‘ç¿»è­¯çµæœã€‚ä¸è¦ç¾…é¦¬æ‹¼éŸ³ã€‚
                `;
            } else if (mode === 'voice_ja') {
                // æ–°å¢ï¼šæ—¥èªèªéŸ³ç¿»è­¯æ¨¡å¼
                prompt = `
                    ä½ æ˜¯ä¸€å€‹å³æ™‚å£è­¯å“¡ã€‚ä½¿ç”¨è€…æ­£åœ¨æ—¥æœ¬æ—…éŠï¼Œå°æ–¹(æ—¥æœ¬äºº)èªªäº†ä¸€æ®µè©±ã€‚
                    
                    ã€å°æ–¹èªªçš„æ—¥æ–‡ã€‘ï¼š "${text}"

                    ä»»å‹™ï¼š
                    è«‹å°‡é€™æ®µæ—¥æ–‡ç¿»è­¯æˆ**å°ç£ç¹é«”ä¸­æ–‡**ï¼Œè®“ä½¿ç”¨è€…èƒ½è½æ‡‚ã€‚
                    
                    æ³¨æ„ï¼š
                    1. åªè¼¸å‡ºä¸­æ–‡ç¿»è­¯çµæœã€‚
                    2. è‹¥æ—¥æ–‡å…§å®¹ä¸å®Œæ•´æˆ–å«ç³Šï¼Œè«‹å˜—è©¦æ ¹æ“šæ—…éŠæƒ…å¢ƒæ¨æ¸¬ä¸¦ç¿»è­¯ã€‚
                `;
            } else {
                // Auto æ¨¡å¼ (ä¿ç•™çµ¦ Enter éµä½¿ç”¨)
                prompt = `
                    ä½ æ˜¯ä¸€ä½å°ˆæ¥­çš„ä¹å·è¦ªå­æ—…éŠé¡§å•èˆ‡éš¨èº«ç¿»è­¯ã€‚
                    ã€è¡Œç¨‹è¡¨è³‡è¨Šã€‘ï¼š${scheduleContext.substring(0, 5000)}
                    ã€ä½¿ç”¨è€…è¼¸å…¥ã€‘ï¼š "${text}"

                    è«‹è‡ªå‹•åˆ¤æ–·ï¼š
                    1. è‹¥æ˜¯å•å•é¡Œ/å°‹æ±‚å»ºè­° -> åŸ·è¡Œè¡Œç¨‹è«®è©¢æ¨¡å¼ã€‚
                    2. è‹¥æ˜¯çŸ­å¥/å–®è© -> åŸ·è¡Œç¿»è­¯æ¨¡å¼ (ä¸­ç¿»æ—¥æˆ–æ—¥ç¿»ä¸­)ã€‚
                    
                    è«‹ç›´æ¥çµ¦å‡ºçµæœï¼Œä¸è¦è§£é‡‹ä½ çš„åˆ¤æ–·é‚è¼¯ã€‚
                `;
            }

            callGemini(prompt);
        }

        async function callGemini(promptText) {
            aiResult.innerHTML = '<span class="loading-dots">AI æ­£åœ¨æ€è€ƒä¸­</span>';
            
            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: promptText }] }]
                    })
                });

                const data = await response.json();
                
                if (data.error) {
                    throw new Error(data.error.message);
                }

                let rawText = data.candidates[0].content.parts[0].text.trim();
                
                // Remove any accidental Markdown code blocks if Gemini ignores instruction
                rawText = rawText.replace(/```(html|json)?/g, '').replace(/```/g, '').trim();

                // Display Logic: Wrap in a nice style since AI returns raw text now
                aiResult.innerHTML = `
                    <div style="font-size: 1.1rem; font-weight: 500; color: #374151; margin-bottom: 15px; line-height: 1.6;">
                        ${rawText.replace(/\n/g, '<br>')}
                    </div>
                `;
                
                // TTS Logic: Check if the result looks like Japanese (Translation Mode)
                // Regex checks for Hiragana or Katakana.
                const hasJapanese = /[\u3040-\u309F\u30A0-\u30FF]/.test(rawText);
                
                // æ”¾å¯¬é™åˆ¶ï¼šåªè¦åµæ¸¬åˆ°æ—¥æ–‡å‡åï¼Œä¸”åœ¨ AI ç¿»è­¯é é¢ä¸­ï¼Œå°±è¦–ç‚ºç¿»è­¯çµæœ
                // ç§»é™¤åš´æ ¼çš„é•·åº¦é™åˆ¶ (rawText.length < 100)ï¼Œæ”¹ç‚ºè¼ƒå¯¬é¬†çš„ 500 å­—ï¼Œé¿å…é•·ç¯‡å°éŠè©è¢«æœ—è®€
                const isTranslationResult = hasJapanese && rawText.length < 500;

                if (aiInputArea.style.display !== 'none' && isTranslationResult) {
                     const speak = () => {
                         // Stop any current speech first
                         speechSynthesis.cancel();
                         
                         const utterance = new SpeechSynthesisUtterance(rawText);
                         utterance.lang = 'ja-JP'; 
                         utterance.rate = 0.9; // Slightly slower
                         
                         // Mobile Safari specific: sometimes voices need to be loaded
                         const voices = speechSynthesis.getVoices();
                         const jaVoice = voices.find(v => v.lang.includes('ja'));
                         if (jaVoice) utterance.voice = jaVoice;

                         speechSynthesis.speak(utterance);
                     };

                     // Try auto-play (might be blocked by browser on mobile)
                     setTimeout(speak, 100);
                     
                     // Always show the replay button if it's Japanese
                     const speakBtn = document.createElement('button');
                     // Updated to Simple Icon and Blue Class
                     speakBtn.innerHTML = `
                        <svg viewBox="0 0 24 24"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"></path></svg>
                        å†æ¬¡æ’­æ”¾
                     `;
                     speakBtn.className = 'btn-ai-play'; // New Blue Class
                     speakBtn.onclick = speak;
                     aiResult.appendChild(speakBtn);
                } 

            } catch (error) {
                console.error('Gemini API Error:', error);
                aiResult.innerHTML = `<span style="color:red">ç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚<br>Error: ${error.message}</span>`;
            }
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            // Default: Open Day 1
            const d1Toggle = document.getElementById('toggle-d1');
            const d1Timeline = document.getElementById('d1');
            if (d1Timeline) { 
                d1Timeline.classList.add('show');
                d1Toggle.classList.add('open');
                updateWeatherWidget('d1'); // Initialize weather
            }
            
            // Check for initial view
            showAiTranslatorMode(); // Initialize AI view state
        });
    </script>
</body>
</html>